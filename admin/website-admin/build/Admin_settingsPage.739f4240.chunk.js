"use strict";var Ga=Object.defineProperty;var Po=Object.getOwnPropertySymbols;var ka=Object.prototype.hasOwnProperty,Za=Object.prototype.propertyIsEnumerable;var So=(k,C,n)=>C in k?Ga(k,C,{enumerable:!0,configurable:!0,writable:!0,value:n}):k[C]=n,Ro=(k,C)=>{for(var n in C||(C={}))ka.call(C,n)&&So(k,n,C[n]);if(Po)for(var n of Po(C))Za.call(C,n)&&So(k,n,C[n]);return k};var ot=(k,C,n)=>new Promise((e,f)=>{var r=le=>{try{B(n.next(le))}catch(de){f(de)}},U=le=>{try{B(n.throw(le))}catch(de){f(de)}},B=le=>le.done?e(le.value):Promise.resolve(le.value).then(r,U);B((n=n.apply(k,C)).next())});(globalThis.webpackChunkwebsite_admin=globalThis.webpackChunkwebsite_admin||[]).push([[5895],{857:(k,C,n)=>{n.r(C),n.d(C,{SettingsPage:()=>Ht,default:()=>Pt});var e=n(53547),f=n(68547),r=n(49656),U=n(35395),B=n(97132),le=n(15482),de=n(32104),ue=n(58836),xe=n(23724),te=n(80117),I=n(94117),T=n(39272),V=n(33483),pe=n(9524),oe=n(64459),ne=n(10407),Ge=n(74657),We=n.n(Ge),ge=n(22754),Z=n.n(ge),Xe=n(45697),g=n.n(Xe),De=n(27987),je=n(49549),be=n(89326),he=n.n(be),ce=n(79274),re=n.n(ce),ke=n(8041);const Le={currentStep:void 0},Ze=(d=Le,c)=>(0,ke.default)(d,u=>{switch(c.type){case"GO_TO":{u.currentStep=c.to;break}default:return u}});var Ee=n(68991);const we={localImage:void 0},W=(d=we,c)=>(0,ke.default)(d,u=>{switch(c.type){case"SET_LOCAL_IMAGE":{u.localImage=c.value;break}default:return u}}),G=({onChangeLogo:d,customLogo:c,goTo:u,Component:E,modalTitle:P,next:O,prev:F,currentStep:A})=>{const[{localImage:y},D]=(0,e.useReducer)(W,we),{formatMessage:Ce}=(0,B.useIntl)(),Fe=_e=>{D({type:"SET_LOCAL_IMAGE",value:_e})},Re=()=>{u(null)};return A?e.createElement(Ee.ModalLayout,{labelledBy:"modal",onClose:Re},e.createElement(Ee.ModalHeader,null,e.createElement(V.Typography,{fontWeight:"bold",as:"h2",id:"modal"},Ce(P))),e.createElement(E,{setLocalImage:Fe,goTo:u,next:O,prev:F,onClose:Re,asset:y||c,onChangeLogo:d})):null};G.defaultProps={Component:void 0,currentStep:void 0,customLogo:void 0,modalTitle:void 0,next:null,prev:null},G.propTypes={Component:g().elementType,currentStep:g().string,customLogo:g().shape({name:g().string,url:g().string,width:g().number,height:g().number,ext:g().string}),goTo:g().func.isRequired,modalTitle:g().shape({id:g().string,defaultMessage:g().string}),next:g().string,onChangeLogo:g().func.isRequired,prev:g().string};const ie=G,R=750,ae=100,J=["image/jpeg","image/png","image/svg+xml"];var q=n(1738),_=n(97833),Y=n(78384),w=n(40264),ve=n(33699),Me=n(16572),Ye=n(96053),ze=n.n(Ye),v=(d,c,u)=>new Promise((E,P)=>{var O=y=>{try{A(u.next(y))}catch(D){P(D)}},F=y=>{try{A(u.throw(y))}catch(D){P(D)}},A=y=>y.done?E(y.value):Promise.resolve(y.value).then(O,F);A((u=u.apply(d,c)).next())});const He={id:"Settings.application.customization.modal.upload.error-format",defaultMessage:"Wrong format uploaded (accepted formats only: jpeg, jpg, png, svg)."},j={id:"Settings.application.customization.modal.upload.error-size",defaultMessage:"The file uploaded is too large (max dimension: {dimension}x{dimension}, max file size: {size}KB)"},me=d=>new Promise(c=>{const u=new FileReader;u.onload=()=>{const E=new Image;E.onload=function(){c({width:E.width,height:E.height})},E.src=u.result},u.readAsDataURL(d)}),z=(d,c)=>({ext:d.name.split(".").pop(),size:d.size/1e3,name:d.name,url:URL.createObjectURL(d),rawFile:d,width:c.width,height:c.height}),H=d=>v(void 0,null,function*(){let c;if(!J.includes(d.type))throw c=new Error("File format"),c.displayMessage=He,c;const E=yield me(d);if(!(E.width<=R&&E.height<=R))throw c=new Error("File sizing"),c.displayMessage=j,c;const O=z(d,E);if(!(O.size<=ae))throw c=new Error("File sizing"),c.displayMessage=j,c;return O});var Se=(d,c,u)=>new Promise((E,P)=>{var O=y=>{try{A(u.next(y))}catch(D){P(D)}},F=y=>{try{A(u.throw(y))}catch(D){P(D)}},A=y=>y.done?E(y.value):Promise.resolve(y.value).then(O,F);A((u=u.apply(d,c)).next())});const Ie=(0,Y.default)(Me.FieldInput)`
  opacity: 0;
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
  z-index: 1;
`,Ne=({setLocalImage:d,goTo:c,next:u,onClose:E})=>{const{formatMessage:P}=(0,B.useIntl)(),[O,F]=(0,e.useState)(!1),[A,y]=(0,e.useState)(void 0),D=(0,e.useRef)(null),Ce=()=>F(!0),Fe=()=>F(!1),Re=Ve=>{Ve.preventDefault(),D.current.click()},_e=()=>Se(void 0,null,function*(){Fe();const Ve=D.current.files[0];if(!!Ve)try{const at=yield H(Ve);d(at),c(u)}catch(at){if(at.displayMessage)y(P(at.displayMessage,{size:ae,dimension:R})),D.current.focus();else throw at}}),et=()=>O?"primary500":A?"danger600":"neutral300";return e.createElement(e.Fragment,null,e.createElement("form",null,e.createElement(I.Box,{paddingLeft:8,paddingRight:8,paddingTop:6,paddingBottom:6},e.createElement(Me.Field,{name:"logo-upload",error:A},e.createElement("label",{htmlFor:"logo-upload"},e.createElement(pe.Stack,{spacing:2},e.createElement(w.Flex,{paddingTop:9,paddingBottom:7,hasRadius:!0,justifyContent:"center",direction:"column",background:O?"primary100":"neutral100",borderColor:et(),borderStyle:"dashed",borderWidth:"1px",position:"relative",onDragEnter:Ce,onDragLeave:Fe},e.createElement(ve.Icon,{color:"primary600",width:`${60/16}rem`,height:`${60/16}rem`,as:ze(),"aria-hidden":!0}),e.createElement(I.Box,{paddingTop:3,paddingBottom:5},e.createElement(V.Typography,{variant:"delta",as:"span"},P({id:"Settings.application.customization.modal.upload.drag-drop",defaultMessage:"Drag and Drop here or"}))),e.createElement(Ie,{accept:J,cursor:"pointer",as:"input",type:"file",name:"files",tabIndex:-1,zIndex:1,onChange:_e,ref:D,id:"logo-upload"}),e.createElement(oe.Button,{type:"button",onClick:Re},P({id:"Settings.application.customization.modal.upload.cta.browse",defaultMessage:"Browse files"})),e.createElement(I.Box,{paddingTop:6},e.createElement(V.Typography,{variant:"pi",textColor:"neutral600"},P({id:"Settings.application.customization.modal.upload.file-validation",defaultMessage:"Max dimension: {dimension}x{dimension}, Max size: {size}KB"},{size:ae,dimension:R})))),e.createElement(Me.FieldError,null)))))),e.createElement(Ee.ModalFooter,{startActions:e.createElement(oe.Button,{onClick:E,variant:"tertiary"},P({id:"Settings.application.customization.modal.cancel",defaultMessage:"Cancel"}))}))};Ne.defaultProps={next:null},Ne.propTypes={goTo:g().func.isRequired,next:g().string,onClose:g().func.isRequired,setLocalImage:g().func.isRequired};const Q=Ne;var fe=n(99136),Te=n(9669),Ot=n.n(Te),xn=(d,c,u)=>new Promise((E,P)=>{var O=y=>{try{A(u.next(y))}catch(D){P(D)}},F=y=>{try{A(u.throw(y))}catch(D){P(D)}},A=y=>y.done?E(y.value):Promise.resolve(y.value).then(O,F);A((u=u.apply(d,c)).next())});const Dn=d=>xn(void 0,null,function*(){try{const c=yield Ot().get(d,{responseType:"blob",timeout:8e3});return new File([c.data],c.config.url,{type:c.headers["content-type"]})}catch(c){throw c.displayMessage={id:"Settings.application.customization.modal.upload.error-network",defaultMessage:"Network error"},c}});var xt=(d,c,u)=>new Promise((E,P)=>{var O=y=>{try{A(u.next(y))}catch(D){P(D)}},F=y=>{try{A(u.throw(y))}catch(D){P(D)}},A=y=>y.done?E(y.value):Promise.resolve(y.value).then(O,F);A((u=u.apply(d,c)).next())});const ft=({goTo:d,next:c,onClose:u,setLocalImage:E})=>{const{formatMessage:P}=(0,B.useIntl)(),[O,F]=(0,e.useState)(""),[A,y]=(0,e.useState)(null),D=Fe=>{F(Fe.target.value)},Ce=Fe=>xt(void 0,null,function*(){Fe.preventDefault();try{const Re=yield Dn(O),_e=yield H(Re);E(_e),d(c)}catch(Re){if(Re.displayMessage)y(P(Re.displayMessage,{size:ae,dimension:R}));else throw Re}});return e.createElement("form",{onSubmit:Ce},e.createElement(I.Box,{paddingLeft:8,paddingRight:8,paddingTop:6,paddingBottom:6},e.createElement(fe.TextInput,{label:P({id:"Settings.application.customization.modal.upload.from-url.input-label",defaultMessage:"URL"}),error:A,onChange:D,value:O,name:"logo-url"})),e.createElement(Ee.ModalFooter,{startActions:e.createElement(oe.Button,{onClick:u,variant:"tertiary"},P({id:"app.components.Button.cancel",defaultMessage:"Cancel"})),endActions:e.createElement(oe.Button,{type:"submit"},P({id:"Settings.application.customization.modal.upload.next",defaultMessage:"Next"}))}))};ft.defaultProps={next:null},ft.propTypes={goTo:g().func.isRequired,next:g().string,onClose:g().func.isRequired,setLocalImage:g().func.isRequired};const Dt=ft,yt=({setLocalImage:d,goTo:c,next:u,onClose:E})=>{const{formatMessage:P}=(0,B.useIntl)();return e.createElement(q.TabGroup,{label:P({id:"Settings.application.customization.modal.tab.label",defaultMessage:"How do you want to upload your assets?"}),variant:"simple"},e.createElement(I.Box,{paddingLeft:8,paddingRight:8},e.createElement(q.Tabs,null,e.createElement(q.Tab,null,P({id:"Settings.application.customization.modal.upload.from-computer",defaultMessage:"From computer"})),e.createElement(q.Tab,null,P({id:"Settings.application.customization.modal.upload.from-url",defaultMessage:"From url"}))),e.createElement(_.Divider,null)),e.createElement(q.TabPanels,null,e.createElement(q.TabPanel,null,e.createElement(Q,{onClose:E,setLocalImage:d,goTo:c,next:u})),e.createElement(q.TabPanel,null,e.createElement(Dt,{onClose:E,setLocalImage:d,goTo:c,next:u}))))};yt.defaultProps={next:null},yt.propTypes={goTo:g().func.isRequired,next:g().string,onClose:g().func.isRequired,setLocalImage:g().func.isRequired};const Xt=yt;var Qe=n(14621);const Lt=({asset:d})=>{const{formatMessage:c}=(0,B.useIntl)();return e.createElement(Qe.Card,null,e.createElement(Qe.CardHeader,null,e.createElement(Qe.CardAsset,{size:"S",src:d.url})),e.createElement(Qe.CardBody,null,e.createElement(Qe.CardContent,null,e.createElement(Qe.CardTitle,null,d.name),e.createElement(Qe.CardSubtitle,null,`${d.ext.toUpperCase()} - ${d.width}\u2715${d.height}`)),e.createElement(Qe.CardBadge,null,c({id:"Settings.application.customization.modal.pending.card-badge",defaultMessage:"image"}))))};Lt.propTypes={asset:g().shape({name:g().string,url:g().string,width:g().number,height:g().number,ext:g().string}).isRequired};const ht=Lt,pt=({onClose:d,asset:c,prev:u,next:E,goTo:P,setLocalImage:O,onChangeLogo:F})=>{const{formatMessage:A}=(0,B.useIntl)(),y=()=>{O(void 0),P(u)},D=()=>{F(c),P(E)};return e.createElement(e.Fragment,null,e.createElement(I.Box,{paddingLeft:8,paddingRight:8,paddingTop:6,paddingBottom:6},e.createElement(w.Flex,{justifyContent:"space-between",paddingBottom:6},e.createElement(w.Flex,{direction:"column",alignItems:"flex-start"},e.createElement(V.Typography,{variant:"pi",fontWeight:"bold"},A({id:"Settings.application.customization.modal.pending.title",defaultMessage:"Logo ready to upload"})),e.createElement(V.Typography,{variant:"pi",textColor:"neutral500"},A({id:"Settings.application.customization.modal.pending.subtitle",defaultMessage:"Manage the chosen logo before uploading it"}))),e.createElement(oe.Button,{onClick:y,variant:"secondary"},A({id:"Settings.application.customization.modal.pending.choose-another",defaultMessage:"Choose another logo"}))),e.createElement(I.Box,{maxWidth:(0,f.pxToRem)(180)},e.createElement(ht,{asset:c}))),e.createElement(Ee.ModalFooter,{startActions:e.createElement(oe.Button,{onClick:d,variant:"tertiary"},A({id:"Settings.application.customization.modal.cancel",defaultMessage:"Cancel"})),endActions:e.createElement(oe.Button,{onClick:D},A({id:"Settings.application.customization.modal.pending.upload",defaultMessage:"Upload logo"}))}))};pt.defaultProps={next:null,prev:null},pt.propTypes={goTo:g().func.isRequired,asset:g().shape({name:g().string,url:g().string,width:g().number,height:g().number,ext:g().string}).isRequired,next:g().string,onClose:g().func.isRequired,onChangeLogo:g().func.isRequired,prev:g().string,setLocalImage:g().func.isRequired};const Ln={upload:{Component:Xt,modalTitle:{id:"Settings.application.customization.modal.upload",defaultMessage:"Upload logo"},next:"pending",prev:null},pending:{Component:pt,modalTitle:{id:"Settings.application.customization.modal.pending",defaultMessage:"Pending logo"},next:null,prev:"upload"}},it=({customLogo:d,defaultLogo:c,onChangeLogo:u,onResetMenuLogo:E})=>{const[{currentStep:P},O]=(0,e.useReducer)(Ze,Le),{Component:F,next:A,prev:y,modalTitle:D}=Ln[P]||{},{formatMessage:Ce}=(0,B.useIntl)(),Fe=Re=>{O({type:"GO_TO",to:Re})};return e.createElement(e.Fragment,null,e.createElement(De.CarouselInput,{label:Ce({id:"Settings.application.customization.carousel.title",defaultMessage:"Logo"}),selectedSlide:0,hint:Ce({id:"Settings.application.customization.carousel-hint",defaultMessage:"Change the admin panel logo (Max dimension: {dimension}x{dimension}, Max file size: {size}KB)"},{size:ae,dimension:R}),previousLabel:"",nextLabel:"",onNext:()=>{},onPrevious:()=>{},secondaryLabel:(d==null?void 0:d.name)||"logo.png",actions:e.createElement(De.CarouselActions,null,e.createElement(je.IconButton,{onClick:()=>Fe(d?"pending":"upload"),label:Ce({id:"Settings.application.customization.carousel.change-action",defaultMessage:"Change logo"}),icon:e.createElement(he(),null)}),d&&e.createElement(je.IconButton,{onClick:E,label:Ce({id:"Settings.application.customization.carousel.reset-action",defaultMessage:"Reset logo"}),icon:e.createElement(re(),null)}))},e.createElement(De.CarouselSlide,{label:Ce({id:"Settings.application.customization.carousel-slide.label",defaultMessage:"Logo slide"})},e.createElement(I.Box,{maxHeight:"40%",maxWidth:"40%",as:"img",src:(d==null?void 0:d.url)||c,alt:Ce({id:"Settings.application.customization.carousel.title",defaultMessage:"Logo"})}))),e.createElement(ie,{Component:F,currentStep:P,onChangeLogo:u,customLogo:d,goTo:Fe,next:A,prev:y,modalTitle:D}))};it.defaultProps={customLogo:null},it.propTypes={customLogo:g().shape({url:g().string,name:g().string}),defaultLogo:g().string.isRequired,onChangeLogo:g().func.isRequired,onResetMenuLogo:g().func.isRequired};const Mn=it,Je={menuLogo:{display:null,submit:{rawFile:null,isReset:!1}}},Qt=(d=Je,c)=>(0,ke.default)(d,u=>{switch(c.type){case"SET_CUSTOM_MENU_LOGO":{u.menuLogo.display=c.value,u.menuLogo.submit.rawFile=c.value.rawFile;break}case"RESET_CUSTOM_MENU_LOGO":{u.menuLogo.display=null,u.menuLogo.submit={rawFile:null,isReset:!0};break}default:return u}});var Jt=n(82492),qt=n.n(Jt);const ct=(d,c)=>qt()(d,{menuLogo:{display:c.menuLogo}}),Mt=(0,e.forwardRef)(({projectSettingsStored:d},c)=>{const{formatMessage:u}=(0,B.useIntl)(),{trackUsage:E}=(0,f.useTracking)(),{logos:{menu:P}}=(0,de.um)(),[{menuLogo:O},F]=(0,e.useReducer)(Qt,Je,()=>ct(Je,d)),A=D=>{F({type:"SET_CUSTOM_MENU_LOGO",value:D})},y=()=>{E("didClickResetLogo"),F({type:"RESET_CUSTOM_MENU_LOGO"})};return(0,e.useImperativeHandle)(c,()=>({getValues:()=>({menuLogo:O.submit})})),e.createElement(I.Box,{hasRadius:!0,background:"neutral0",shadow:"tableShadow",paddingTop:6,paddingBottom:6,paddingRight:7,paddingLeft:7},e.createElement(V.Typography,{variant:"delta",as:"h3"},u({id:"Settings.application.customization",defaultMessage:"Customization"})),e.createElement(T.Grid,{paddingTop:4},e.createElement(T.GridItem,{col:6,s:12},e.createElement(Mn,{onChangeLogo:A,customLogo:O.display,defaultLogo:P.default,onResetMenuLogo:y}))))});Mt.defaultProps={projectSettingsStored:null},Mt.propTypes={projectSettingsStored:g().shape({menuLogo:g().shape({url:g().string,name:g().string})})};const dt=Mt;var Et=n(63955),vt=n(68718),It=n.n(vt),_t=Object.defineProperty,Ft=Object.defineProperties,Bt=Object.getOwnPropertyDescriptors,Ct=Object.getOwnPropertySymbols,en=Object.prototype.hasOwnProperty,jt=Object.prototype.propertyIsEnumerable,wt=(d,c,u)=>c in d?_t(d,c,{enumerable:!0,configurable:!0,writable:!0,value:u}):d[c]=u,In=(d,c)=>{for(var u in c||(c={}))en.call(c,u)&&wt(d,u,c[u]);if(Ct)for(var u of Ct(c))jt.call(c,u)&&wt(d,u,c[u]);return d},tn=(d,c)=>Ft(d,Bt(c));const Nt=d=>It()(d,(c,u,E)=>{u&&u.url?c[E]=tn(In({},u),{url:(0,f.prefixFileUrlWithBackendUrl)(u.url)}):c[E]=u},{});var bt=(d,c,u)=>new Promise((E,P)=>{var O=y=>{try{A(u.next(y))}catch(D){P(D)}},F=y=>{try{A(u.throw(y))}catch(D){P(D)}},A=y=>y.done?E(y.value):Promise.resolve(y.value).then(O,F);A((u=u.apply(d,c)).next())});const on=()=>bt(void 0,null,function*(){const{data:d}=yield Et.be.get("/admin/project-settings");return Nt(d)}),an=d=>bt(void 0,null,function*(){const{data:c}=yield Et.be.post("/admin/project-settings",d);return Nt(c)}),$t=d=>{const c=new FormData;return Object.entries(d).forEach(([u,E])=>{E&&E.rawFile instanceof File&&c.append(u,E.rawFile),E&&E.isReset&&c.append(u,null)}),c};var sn=(d,c,u)=>new Promise((E,P)=>{var O=y=>{try{A(u.next(y))}catch(D){P(D)}},F=y=>{try{A(u.throw(y))}catch(D){P(D)}},A=y=>y.done?E(y.value):Promise.resolve(y.value).then(O,F);A((u=u.apply(d,c)).next())});const rn=[{action:"admin::project-settings.update",subject:null}],Wt=()=>{const d=(0,e.useRef)(),c=(0,f.useNotification)(),{trackUsage:u}=(0,f.useTracking)(),{formatMessage:E}=(0,B.useIntl)(),P=(0,xe.useQueryClient)();(0,f.useFocusWhenNavigate)();const O=(0,f.useAppInfos)(),{shouldUpdateStrapi:F,latestStrapiReleaseTag:A,strapiVersion:y}=O,{updateProjectSettings:D}=(0,de.um)(),{data:Ce}=(0,xe.useQuery)("project-settings",on),Fe=O.communityEdition?"app.components.UpgradePlanModal.text-ce":"app.components.UpgradePlanModal.text-ee",Re=(0,xe.useMutation)(et=>an(et),{onSuccess:et=>sn(void 0,[et],function*({menuLogo:Ve}){yield P.invalidateQueries("project-settings",{refetchActive:!0}),D({menuLogo:Ve==null?void 0:Ve.url})})}),_e=()=>{const et=d.current.getValues(),Ve=$t(et);Re.mutate(Ve,{onSuccess:()=>{const{menuLogo:at}=et;at.rawFile&&u("didChangeLogo")},onError:()=>{c({type:"warning",message:{id:"notification.error",defaultMessage:"An error occurred"}})}})};return e.createElement(U.Layout,null,e.createElement(f.SettingsPageTitle,{name:"Application"}),e.createElement(te.Main,null,e.createElement(U.HeaderLayout,{title:E({id:"Settings.application.title",defaultMessage:"Overview"}),subtitle:E({id:"Settings.application.description",defaultMessage:"Administration panel\u2019s global information"}),primaryAction:e.createElement(oe.Button,{onClick:_e,startIcon:e.createElement(Z(),null)},E({id:"global.save",defaultMessage:"Save"}))}),e.createElement(U.ContentLayout,null,e.createElement(pe.Stack,{spacing:6},e.createElement(I.Box,{hasRadius:!0,background:"neutral0",shadow:"tableShadow",paddingTop:6,paddingBottom:6,paddingRight:7,paddingLeft:7},e.createElement(pe.Stack,{spacing:5},e.createElement(V.Typography,{variant:"delta",as:"h3"},E({id:"global.details",defaultMessage:"Details"})),e.createElement(T.Grid,{paddingTop:1},e.createElement(T.GridItem,{col:6,s:12},e.createElement(V.Typography,{variant:"sigma",textColor:"neutral600"},E({id:"Settings.application.strapiVersion",defaultMessage:"strapi version"})),e.createElement(V.Typography,{as:"p"},"v",y),e.createElement(ne.Link,{href:O.communityEdition?"https://discord.strapi.io":"https://support.strapi.io/support/home",isExternal:!0,endIcon:e.createElement(We(),null)},E({id:"Settings.application.get-help",defaultMessage:"Get help"}))),e.createElement(T.GridItem,{col:6,s:12},e.createElement(V.Typography,{variant:"sigma",textColor:"neutral600"},E({id:"Settings.application.edition-title",defaultMessage:"current plan"})),e.createElement(V.Typography,{as:"p"},E({id:Fe,defaultMessage:`${O.communityEdition?"Community Edition":"Enterprise Edition"}`})))),e.createElement(T.Grid,{paddingTop:1},e.createElement(T.GridItem,{col:6,s:12},F&&e.createElement(ne.Link,{href:`https://github.com/strapi/strapi/releases/tag/${A}`,isExternal:!0,endIcon:e.createElement(We(),null)},E({id:"Settings.application.link-upgrade",defaultMessage:"Upgrade your admin panel"}))),e.createElement(T.GridItem,{col:6,s:12},e.createElement(ne.Link,{href:"https://strapi.io/pricing-self-hosted",isExternal:!0,endIcon:e.createElement(We(),null)},E({id:"Settings.application.link-pricing",defaultMessage:"See all pricing plans"})))),e.createElement(I.Box,{paddingTop:1},e.createElement(V.Typography,{variant:"sigma",textColor:"neutral600"},E({id:"Settings.application.node-version",defaultMessage:"node version"})),e.createElement(V.Typography,{as:"p"},O.nodeVersion)))),Ce&&e.createElement(f.CheckPermissions,{permissions:rn},e.createElement(dt,{ref:d,projectSettingsStored:Ce}))))))};var ln=n(94654),cn=n.n(ln);const un=d=>cn()(d,u=>u.links).map(u=>(0,ue.ot)(u.Component,u.to,u.exact||!1)),jn=d=>d.filter(c=>!c.links.every(u=>u.isDisplayed===!1)),Ut=(()=>window&&window.strapi&&window.strapi.isEE?n(18290).Z:n(56368).Z)(),pn=(()=>window&&window.strapi&&window.strapi.isEE?n(28099).Z:n(8114).Z)(),zt=[{Component:()=>({default:pn}),to:"/settings/roles",exact:!0},{Component:()=>({default:Ut}),to:"/settings/roles/duplicate/:id",exact:!0},{Component:()=>({default:Ut}),to:"/settings/roles/new",exact:!0},{Component:()=>ot(this,null,function*(){return yield n.e(2544).then(n.bind(n,50287))}),to:"/settings/roles/:id",exact:!0},{Component:()=>ot(this,null,function*(){return yield n.e(5199).then(n.bind(n,61322))}),to:"/settings/users",exact:!0},{Component:()=>ot(this,null,function*(){return yield n.e(4263).then(n.bind(n,86294))}),to:"/settings/users/:id",exact:!0},{Component:()=>ot(this,null,function*(){return yield Promise.all([n.e(8252),n.e(5162)]).then(n.bind(n,2937))}),to:"/settings/webhooks/create",exact:!0},{Component:()=>ot(this,null,function*(){return yield Promise.all([n.e(8252),n.e(5162)]).then(n.bind(n,27103))}),to:"/settings/webhooks/:id",exact:!0},{Component:()=>ot(this,null,function*(){return yield n.e(4121).then(n.bind(n,77967))}),to:"/settings/webhooks",exact:!0},{Component:()=>ot(this,null,function*(){return yield n.e(8056).then(n.bind(n,81666))}),to:"/settings/api-tokens",exact:!0},{Component:()=>ot(this,null,function*(){return yield n.e(4299).then(n.bind(n,1424))}),to:"/settings/api-tokens/create",exact:!0},{Component:()=>ot(this,null,function*(){return yield n.e(92).then(n.bind(n,51037))}),to:"/settings/api-tokens/:id",exact:!0}],mn=[...(()=>window&&window.strapi&&window.strapi.isEE?n(49475).Z:n(73258).Z)(),...zt];var rt=n(95431),gn=Object.defineProperty,fn=Object.defineProperties,yn=Object.getOwnPropertyDescriptors,mt=Object.getOwnPropertySymbols,hn=Object.prototype.hasOwnProperty,Vt=Object.prototype.propertyIsEnumerable,Tt=(d,c,u)=>c in d?gn(d,c,{enumerable:!0,configurable:!0,writable:!0,value:u}):d[c]=u,Gt=(d,c)=>{for(var u in c||(c={}))hn.call(c,u)&&Tt(d,u,c[u]);if(mt)for(var u of mt(c))Vt.call(c,u)&&Tt(d,u,c[u]);return d},kt=(d,c)=>fn(d,yn(c));const Zt=({menu:d})=>{const{formatMessage:c}=(0,B.useIntl)(),E=jn(d).map(O=>kt(Gt({},O),{title:O.intlLabel,links:O.links.map(F=>kt(Gt({},F),{title:F.intlLabel,name:F.id}))})),P=c({id:"global.settings",defaultMessage:"Settings"});return e.createElement(rt.SubNav,{ariaLabel:P},e.createElement(rt.SubNavHeader,{label:P}),e.createElement(rt.SubNavSections,null,E.map(O=>e.createElement(rt.SubNavSection,{key:O.id,label:c(O.intlLabel)},O.links.map(F=>e.createElement(rt.SubNavLink,{as:r.NavLink,withBullet:F.hasNotification,to:F.to,key:F.id},c(F.intlLabel)))))))};Zt.propTypes={menu:g().array.isRequired};const En=Zt;function Ht(){const{settingId:d}=(0,r.useParams)(),{settings:c}=(0,f.useStrapiApp)(),{formatMessage:u}=(0,B.useIntl)(),{isLoading:E,menu:P}=(0,de.Te)(),O=(0,e.useMemo)(()=>(0,ue.WW)(mn.map(({to:y,Component:D,exact:Ce})=>(0,ue.ot)(D,y,Ce))),[]),F=un(c);if(E)return e.createElement(f.LoadingIndicatorPage,null);if(!d)return e.createElement(r.Redirect,{to:"/settings/application-infos"});const A=u({id:"global.settings",defaultMessage:"Settings"});return e.createElement(U.Layout,{sideNav:e.createElement(En,{menu:P})},e.createElement(le.Helmet,{title:A}),e.createElement(r.Switch,null,e.createElement(r.Route,{path:"/settings/application-infos",component:Wt,exact:!0}),O,F))}const Pt=(0,e.memo)(Ht)},56368:(k,C,n)=>{n.d(C,{Z:()=>U});var e=n(53547),f=n(49656);const U=()=>e.createElement(f.Redirect,{to:"/404"})},14934:(k,C,n)=>{n.d(C,{Z:()=>f});const f=!0},48496:(k,C,n)=>{n.d(C,{Z:()=>f});const f=!0},93485:(k,C,n)=>{n.d(C,{Z:()=>f});const f=!0},55632:(k,C,n)=>{n.d(C,{Z:()=>f});const f=!0},39672:(k,C,n)=>{n.d(C,{Z:()=>f});const f=!0},79160:(k,C,n)=>{n.d(C,{Z:()=>Va});var e=n(53547),f=n(45697),r=n.n(f),U=n(68547),B=n(1738),le=n(18721),de=n.n(le),ue=n(41609),xe=n.n(ue),te=n(97132),I=n(94117),T=n(78384),V=n(89734),pe=n.n(V),oe=n(32080),ne=n.n(oe),Ge=n(80499),We=n.n(Ge),ge=n(46458),Z=n(40264),Xe=n(27361),g=n.n(Xe),De=n(57557),je=n.n(De),be=n(32104),he=n(17581),ce=n.n(he),re=n(64459);const ke=T.default.div`
  position: relative;

  ${({hasConditions:a,disabled:t,theme:o})=>a&&`
    &:before {
      content: '';
      position: absolute;
      top: -3px;
      left: -10px;
      width: 6px;
      height: 6px;
      border-radius: ${20/16}rem;;
      background: ${t?o.colors.neutral100:o.colors.primary600};
    }
  `}
`,Le=({onClick:a,className:t,hasConditions:o,variant:s})=>{const{formatMessage:l}=(0,te.useIntl)();return e.createElement(ke,{hasConditions:o,className:t},e.createElement(re.Button,{variant:s,startIcon:e.createElement(ce(),null),onClick:a},l({id:"global.settings",defaultMessage:"Settings"})))};Le.defaultProps={className:null,hasConditions:!1,variant:"tertiary"},Le.propTypes={onClick:r().func.isRequired,className:r().string,hasConditions:r().bool,variant:r().string};const Ue=(0,T.default)(Le)``;var Ze=n(97833),Ee=n(9524),we=n(68991),st=n(44981),W=n(33483),G=n(8041),ie=n(7739),R=n.n(ie),ae=n(11700),J=n.n(ae),q=n(2632);const _=`${120/16}rem`,Y=`${200/16}rem`,w=`${53/16}rem`,ve=(()=>window&&window.strapi&&window.strapi.isEE?n(15272).Z:n(14934).Z)(),Me=(0,T.default)(Z.Flex).withConfig({displayName:"ActionRow__FlexWrapper",componentId:"sc-1bqpgdl-0"})(["height:",";"],w),Ye=a=>{let{arrayOfOptionsGroupedByCategory:t,isFormDisabled:o,isGrey:s,label:l,name:i,onChange:p,value:m}=a;const{formatMessage:h}=(0,te.useIntl)(),b=t.reduce((M,K)=>{const[N,X]=K,x={label:J()(N),children:X.map($=>({label:$.displayName,value:$.id}))};return[...M,x]},[]),S=Object.values(m).map(M=>Object.entries(M).filter(K=>{let[,N]=K;return N}).map(K=>{let[N]=K;return N})).flat(),L=M=>{const[[,K]]=t,N=K.reduce((X,x)=>Ro({[x.id]:M.includes(x.id)},X),{});p(i,N)};return e.createElement(Me,{as:"li",background:s?"neutral100":"neutral0"},e.createElement(Z.Flex,{paddingLeft:6,style:{width:180}},e.createElement(W.Typography,{variant:"sigma",textColor:"neutral600"},h({id:"Settings.permissions.conditions.can",defaultMessage:"Can"}),"\xA0"),e.createElement(W.Typography,{variant:"sigma",title:l,textColor:"primary600",ellipsis:!0},h({id:`Settings.roles.form.permissions.${l.toLowerCase()}`,defaultMessage:l})),e.createElement(W.Typography,{variant:"sigma",textColor:"neutral600"},"\xA0",h({id:"Settings.permissions.conditions.when",defaultMessage:"When"}))),e.createElement(I.Box,{style:{maxWidth:430,width:"100%"}},e.createElement(q.MultiSelectNested,{id:i,customizeContent:M=>`${M.length} currently selected`,onChange:L,value:S,options:b,disabled:o||ve})))};Ye.propTypes={arrayOfOptionsGroupedByCategory:r().array.isRequired,isFormDisabled:r().bool.isRequired,isGrey:r().bool.isRequired,label:r().string.isRequired,name:r().string.isRequired,value:r().object.isRequired,onChange:r().func.isRequired};const ze=Ye;var v=n(96486);const He=(a,t)=>a.reduce((o,s)=>(o[s.id]=(0,v.get)(t,s.id,!1),o),{}),j=(a,t)=>a.reduce((o,s)=>{const[l,i]=s,p=He(i,t);return o[l]=p,o},{}),z=(a,t,o)=>a.reduce((s,l)=>{const i=(0,v.get)(t,[...l.pathToConditionsObject,"conditions"],{}),p=j(o,i);return s[l.pathToConditionsObject.join("..")]=p,s},{});var H=Object.defineProperty,Se=Object.getOwnPropertySymbols,Ie=Object.prototype.hasOwnProperty,Ne=Object.prototype.propertyIsEnumerable,Q=(a,t,o)=>t in a?H(a,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[t]=o,fe=(a,t)=>{for(var o in t||(t={}))Ie.call(t,o)&&Q(a,o,t[o]);if(Se)for(var o of Se(t))Ne.call(t,o)&&Q(a,o,t[o]);return a};const Te=({actions:a,headerBreadCrumbs:t,isFormDisabled:o,onClosed:s,onToggle:l})=>{const{formatMessage:i}=(0,te.useIntl)(),{availableConditions:p,modifiedData:m,onChangeConditions:h}=(0,be.$_)(),b=(0,e.useMemo)(()=>Object.entries(R()(p,"category")),[p]),S=a.filter(({isDisplayed:x,hasSomeActionsSelected:$,hasAllActionsSelected:ee})=>x&&($||ee)),L=(0,e.useMemo)(()=>z(S,m,b),[S,m,b]),[M,K]=(0,e.useState)(L),N=(x,$)=>{K((0,G.default)(ee=>{ee[x]||(ee[x]={}),ee[x].default||(ee[x].default={}),ee[x].default=$}))},X=()=>{const x=Object.entries(M).reduce(($,ee)=>{const[se,ye]=ee,$e=Object.values(ye).reduce((Oe,Pe)=>fe(fe({},Oe),Pe),{});return $[se]=$e,$},{});h(x),l()};return e.createElement(we.ModalLayout,{labelledBy:"condition-modal-breadcrumbs",onClose:s},e.createElement(we.ModalHeader,null,e.createElement(st.Breadcrumbs,{id:"condition-modal-breadcrumbs",label:t.join(", ")},t.map(x=>e.createElement(st.Crumb,{key:x},J()(i({id:x,defaultMessage:x})))))),e.createElement(I.Box,{padding:8},e.createElement(Ee.Stack,{spacing:6},e.createElement(W.Typography,{variant:"beta",as:"h2"},i({id:"Settings.permissions.conditions.define-conditions",defaultMessage:"Define conditions"})),e.createElement(I.Box,null,e.createElement(Ze.Divider,null)),e.createElement(I.Box,null,S.length===0&&e.createElement(W.Typography,null,i({id:"Settings.permissions.conditions.no-actions",defaultMessage:"You first need to select actions (create, read, update, ...) before defining conditions on them."})),e.createElement("ul",null,S.map(({actionId:x,label:$,pathToConditionsObject:ee},se)=>{const ye=ee.join("..");return e.createElement(ze,{key:x,arrayOfOptionsGroupedByCategory:b,label:$,isFormDisabled:o,isGrey:se%2===0,name:ye,onChange:N,value:g()(M,ye,{})})}))))),e.createElement(we.ModalFooter,{startActions:e.createElement(re.Button,{variant:"tertiary",onClick:l},i({id:"app.components.Button.cancel",defaultMessage:"Cancel"})),endActions:e.createElement(re.Button,{onClick:X},i({id:"Settings.permissions.conditions.apply",defaultMessage:"Apply"}))}))};Te.propTypes={actions:r().arrayOf(r().shape({actionId:r().string.isRequired,checkboxName:r().string,hasSomeActionsSelected:r().bool.isRequired,hasAllActionsSelected:r().bool,isDisplayed:r().bool.isRequired,label:r().string})).isRequired,headerBreadCrumbs:r().arrayOf(r().string).isRequired,isFormDisabled:r().bool.isRequired,onClosed:r().func.isRequired,onToggle:r().func.isRequired};const Ot=Te,At=T.default.div`
  width: ${_};
`,xt=(0,T.default)(Z.Flex)`
  padding-right: ${({theme:a})=>a.spaces[2]};
  overflow: hidden;
  flex: 1;
  ${({isCollapsable:a})=>a&&"cursor: pointer;"}
`;var ft=Object.defineProperty,Dt=Object.getOwnPropertySymbols,yt=Object.prototype.hasOwnProperty,Xt=Object.prototype.propertyIsEnumerable,Qe=(a,t,o)=>t in a?ft(a,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[t]=o,Lt=(a,t)=>{for(var o in t||(t={}))yt.call(t,o)&&Qe(a,o,t[o]);if(Dt)for(var o of Dt(t))Xt.call(t,o)&&Qe(a,o,t[o]);return a};const ht=({children:a,isCollapsable:t,isActive:o,isFormDisabled:s,label:l,onChange:i,onClick:p,checkboxName:m,someChecked:h,value:b})=>{const{formatMessage:S}=(0,te.useIntl)();return e.createElement(Z.Flex,{alignItems:"center",paddingLeft:6,style:{width:Y,flexShrink:0}},e.createElement(I.Box,{paddingRight:2},e.createElement(ge.BaseCheckbox,{name:m,"aria-label":S({id:"Settings.permissions.select-all-by-permission",defaultMessage:"Select all {label} permissions"},{label:l}),disabled:s,onValueChange:L=>i({target:{name:m,value:L}}),indeterminate:h,value:b})),e.createElement(xt,Lt({title:l,alignItems:"center",isCollapsable:t},t&&{onClick:p,"aria-expanded":o,onKeyDown:({key:L})=>(L==="Enter"||L===" ")&&p(),tabIndex:0,role:"button"}),e.createElement(W.Typography,{fontWeight:o?"bold":"",textColor:o?"primary600":"neutral800",ellipsis:!0},J()(l)),a))};ht.defaultProps={children:null,checkboxName:"",onChange:()=>{},value:!1,someChecked:!1,isCollapsable:!1},ht.propTypes={checkboxName:r().string,children:r().node,label:r().string.isRequired,isCollapsable:r().bool,isFormDisabled:r().bool.isRequired,onChange:r().func,onClick:r().func.isRequired,someChecked:r().bool,value:r().bool,isActive:r().bool.isRequired};const pt=(0,e.memo)(ht),Yt=a=>(0,v.isObject)(a)?(0,v.flattenDeep)(Object.values(a).map(t=>(0,v.isObject)(t)?Yt(t):t)):[],lt=Yt,it=a=>a?Object.keys(a).reduce((t,o)=>(o!=="conditions"&&(t[o]=a[o]),t),{}):null,Je=a=>{const t=it(a),o=lt(t);if(!o.length)return{hasAllActionsSelected:!1,hasSomeActionsSelected:!1};const s=o.every(i=>i),l=o.some(i=>i)&&!s;return{hasAllActionsSelected:s,hasSomeActionsSelected:l}},Qt=(a,t,o)=>a.map(({actionId:s,isDisplayed:l,applyToProperties:i,label:p})=>{if(!l)return{actionId:s,hasSomeActionsSelected:!1,isDisplayed:l};const m=[...o.split(".."),s],h=(0,v.isEmpty)(i)?[...m,"properties","enabled"]:m,b=h.join(".."),S=(0,v.get)(t,[...m,"conditions"],null),L=lt(S).some(X=>X);if((0,v.isEmpty)(i)){const X=(0,v.get)(t,h,!1);return{actionId:s,checkboxName:b,hasAllActionsSelected:X,hasConditions:L,hasSomeActionsSelected:X,isDisplayed:l,isParentCheckbox:!1,label:p,pathToConditionsObject:m}}const M=(0,v.get)(t,h,null),{hasAllActionsSelected:K,hasSomeActionsSelected:N}=Je(M);return{actionId:s,checkboxName:b,hasAllActionsSelected:K,hasConditions:L,hasSomeActionsSelected:N,isDisplayed:l,isParentCheckbox:!0,label:p,pathToConditionsObject:m}});var Jt=n(40413),qt=n.n(Jt);const ct=(0,T.default)(qt())`
  display: none;
  width: ${10/16}rem;
  transform: rotate(${({$isActive:a})=>a?"180":"0"}deg);
  margin-left: ${({theme:a})=>a.spaces[2]};
`,dt=a=>`
  ${W.Typography} {
    color: ${a.colors.primary600};
    font-weight: ${a.fontWeights.bold}
  }
  ${ct} {
    display: block;
    path {
      fill: ${a.colors.primary600}
    };
  }
`,Et=(()=>window&&window.strapi&&window.strapi.isEE?n(43549).Z:n(55632).Z)(),vt=(a,t)=>`
  ${It} {
    background-color: ${a.colors.primary100};
    color: ${a.colors.primary600};
    border-radius: ${t?"2px 2px 0 0":"2px"};
  }
  ${Bt} {
    display: flex;
  }
  ${Ue} {
    display: block;
  }
  &:hover {
   ${dt(a)}
  }

  &:focus-within {
    ${o=>{let{theme:s,isActive:l}=o;return vt(s,l)}}
  }
  
`,It=T.default.div.withConfig({displayName:"Collapse__Wrapper",componentId:"sc-132fji1-0"})(["flex:1;display:flex;align-items:center;height:",";background-color:",";border:1px solid transparent;"],w,a=>{let{isGrey:t,theme:o}=a;return t?o.colors.neutral100:o.colors.neutral0}),_t=T.default.div.withConfig({displayName:"Collapse__BoxWrapper",componentId:"sc-132fji1-1"})(["display:inline-flex;min-width:100%;","{display:none;}"," &:hover{","}"],Ue,a=>{let{isActive:t,theme:o}=a;return t&&vt(o,t)},a=>{let{theme:t,isActive:o}=a;return vt(t,o)}),Ft=(0,T.default)(Z.Flex).withConfig({displayName:"Collapse__Cell",componentId:"sc-132fji1-2"})(["width:",";position:relative;"],_),Bt=(0,T.default)(I.Box).withConfig({displayName:"Collapse__Chevron",componentId:"sc-132fji1-3"})(["display:none;svg{width:11px;}*{fill:",";}"],a=>{let{theme:t}=a;return t.colors.primary600}),Ct=T.default.span.withConfig({displayName:"Collapse__TinyDot",componentId:"sc-132fji1-4"})(["position:absolute;top:-6px;left:37px;width:6px;height:6px;border-radius:20px;background:",";"],a=>{let{theme:t}=a;return t.colors.primary600}),en=(0,T.default)(I.Box).withConfig({displayName:"Collapse__AbsoluteBox",componentId:"sc-132fji1-5"})(["position:absolute;right:9px;transform:translateY(10px);"]),jt=a=>{let{availableActions:t,isActive:o,isGrey:s,isFormDisabled:l,label:i,onClickToggle:p,pathToData:m}=a;const[h,b]=(0,e.useState)(!1),{formatMessage:S}=(0,te.useIntl)(),{modifiedData:L,onChangeParentCheckbox:M,onChangeSimpleCheckbox:K}=(0,be.$_)(),N=()=>{b(Oe=>!Oe)},X=()=>{b(!1)},x=g()(L,m.split(".."),{}),$=(0,e.useMemo)(()=>Object.keys(x).reduce((Oe,Pe)=>(Oe[Pe]=je()(x[Pe],"conditions"),Oe),{}),[x]),{hasAllActionsSelected:ee,hasSomeActionsSelected:se}=Je($),ye=(0,e.useMemo)(()=>Qt(t,L,m),[t,L,m]),$e=ye.some(Oe=>{let{hasConditions:Pe}=Oe;return Pe});return e.createElement(_t,{isActive:o},e.createElement(It,{isGrey:s},e.createElement(pt,{isCollapsable:!0,isFormDisabled:l,label:i,checkboxName:m,onChange:M,onClick:p,someChecked:se,value:ee,isActive:o},e.createElement(Bt,{paddingLeft:2},o?e.createElement(We(),null):e.createElement(ne(),null))),e.createElement(Z.Flex,{style:{flex:1}},ye.map(Oe=>{let{actionId:Pe,hasConditions:Ae,hasAllActionsSelected:Be,hasSomeActionsSelected:qe,isDisplayed:tt,isParentCheckbox:nt,checkboxName:Ke,label:gt}=Oe;return tt?nt?e.createElement(Ft,{key:Pe,justifyContent:"center",alignItems:"center"},Ae&&e.createElement(Ct,null),e.createElement(ge.BaseCheckbox,{disabled:l||Et,name:Ke,"aria-label":S({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:`${gt} ${i}`}),onValueChange:ut=>{M({target:{name:Ke,value:ut}})},indeterminate:qe,value:Be})):e.createElement(Ft,{key:Pe,justifyContent:"center",alignItems:"center"},Ae&&e.createElement(Ct,null),e.createElement(ge.BaseCheckbox,{disabled:l||Et,indeterminate:Ae,name:Ke,onValueChange:ut=>{K({target:{name:Ke,value:ut}})},value:Be})):e.createElement(At,{key:Pe})})),h&&e.createElement(Ot,{headerBreadCrumbs:[i,"app.components.LeftMenuLinkContainer.settings"],actions:ye,isFormDisabled:l,onClosed:X,onToggle:N})),e.createElement(en,null,e.createElement(Ue,{onClick:N,hasConditions:$e})))};jt.propTypes={availableActions:r().array.isRequired,isActive:r().bool.isRequired,isGrey:r().bool.isRequired,isFormDisabled:r().bool.isRequired,label:r().string.isRequired,onClickToggle:r().func.isRequired,pathToData:r().string.isRequired};const wt=jt,tn=(a,t)=>a.map(o=>{const s=Array.isArray(o.applyToProperties)&&o.applyToProperties.indexOf(t)!==-1&&o.isDisplayed;return{label:o.label,actionId:o.actionId,isActionRelatedToCurrentProperty:s}}),nn=(0,T.default)(Z.Flex)`
  width: ${_};
  flex-shrink: 0;
`,Nt=(0,T.default)(Z.Flex)`
  width: ${Y};
  height: ${w};
  flex-shrink: 0;
`,bt=({headers:a,label:t})=>{const{formatMessage:o}=(0,te.useIntl)(),s=o({id:"Settings.roles.form.permission.property-label",defaultMessage:"{label} permissions"},{label:t});return e.createElement(Z.Flex,null,e.createElement(Nt,{alignItems:"center",paddingLeft:6},e.createElement(W.Typography,{variant:"sigma",textColor:"neutral500"},s)),a.map(l=>l.isActionRelatedToCurrentProperty?e.createElement(nn,{justifyContent:"center",key:l.label},e.createElement(W.Typography,{variant:"sigma",textColor:"neutral500"},o({id:`Settings.roles.form.permissions.${l.label.toLowerCase()}`,defaultMessage:l.label}))):e.createElement(nn,{key:l.label})))};bt.propTypes={headers:r().arrayOf(r().shape({label:r().string.isRequired,isActionRelatedToCurrentProperty:r().bool.isRequired})).isRequired,label:r().string.isRequired};const on=bt,an=T.default.span`
  color: ${({theme:a})=>a.colors.danger700};
  padding-left: ${({theme:a})=>a.spaces[1]}px;
`,$t=()=>e.createElement(an,null,"*");var sn=Object.defineProperty,rn=Object.defineProperties,Fn=Object.getOwnPropertyDescriptors,Wt=Object.getOwnPropertySymbols,ln=Object.prototype.hasOwnProperty,cn=Object.prototype.propertyIsEnumerable,dn=(a,t,o)=>t in a?sn(a,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[t]=o,un=(a,t)=>{for(var o in t||(t={}))ln.call(t,o)&&dn(a,o,t[o]);if(Wt)for(var o of Wt(t))cn.call(t,o)&&dn(a,o,t[o]);return a},Bn=(a,t)=>rn(a,Fn(t));const Ut=(a,t)=>a.map(o=>{const s=Array.isArray(o.subjects)&&o.subjects.indexOf(t)!==-1;return Bn(un({},o),{isDisplayed:s})});var pn=n(87462),wn=Object.defineProperty,zt=Object.getOwnPropertySymbols,Nn=Object.prototype.hasOwnProperty,mn=Object.prototype.propertyIsEnumerable,rt=(a,t,o)=>t in a?wn(a,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[t]=o,gn=(a,t)=>{for(var o in t||(t={}))Nn.call(t,o)&&rt(a,o,t[o]);if(zt)for(var o of zt(t))mn.call(t,o)&&rt(a,o,t[o]);return a};const fn=(0,T.default)(I.Box)`
  transform: translate(-4px, -12px);

  &:before {
    content: '';
    width: ${4/16}rem;
    height: ${12/16}rem;
    background: ${({theme:a})=>a.colors.primary200};
    display: block;
  }
`,yn=T.default.svg`
  position: relative;
  flex-shrink: 0;
  transform: translate(-0.5px, -1px);

  * {
    fill: ${({theme:a,color:t})=>a.colors[t]};
  }
`,mt=a=>e.createElement(fn,null,e.createElement(yn,gn({width:"20",height:"23",viewBox:"0 0 20 23",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a),e.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.02477 14.7513C8.65865 17.0594 11.6046 18.6059 17.5596 18.8856C18.6836 18.9384 19.5976 19.8435 19.5976 20.9688V20.9688C19.5976 22.0941 18.6841 23.0125 17.5599 22.9643C10.9409 22.6805 6.454 20.9387 3.75496 17.1258C0.937988 13.1464 0.486328 7.39309 0.486328 0.593262H4.50974C4.50974 7.54693 5.06394 11.9813 7.02477 14.7513Z",fill:"#D9D8FF"})));mt.defaultProps={fill:"primary200"},mt.propTypes={fill:r().string};const hn=(0,e.memo)(mt),Vt=(()=>window&&window.strapi&&window.strapi.isEE?n(73071).Z:n(93485).Z)(),Tt=(0,T.default)(Z.Flex).withConfig({displayName:"SubActionRow__Cell",componentId:"sc-7y8yzq-0"})(["width:",";position:relative;"],_),Gt=(0,T.default)(Z.Flex).withConfig({displayName:"SubActionRow__RowWrapper",componentId:"sc-7y8yzq-1"})(["height:",";"],w),kt=(0,T.default)(I.Box).withConfig({displayName:"SubActionRow__Wrapper",componentId:"sc-7y8yzq-2"})(["padding-left:","rem;"],31/16),Zt=(0,T.default)(I.Box).withConfig({displayName:"SubActionRow__LeftBorderTimeline",componentId:"sc-7y8yzq-3"})(["border-left:",";"],a=>{let{isVisible:t,theme:o}=a;return t?`4px solid ${o.colors.primary200}`:"4px solid transparent"}),En=(0,T.default)(Z.Flex).withConfig({displayName:"SubActionRow__RowStyle",componentId:"sc-7y8yzq-4"})(["padding-left:",";width:","px;"," ",";"],a=>{let{theme:t}=a;return t.spaces[4]},a=>{let{level:t}=a;return 145-t*36},a=>{let{isCollapsable:t,theme:o}=a;return t&&`
      ${ct} {
        display: block;
        color: ${o.colors.neutral100};
      }
      &:hover {
        ${dt(o)}
      }
  `},a=>{let{isActive:t,theme:o}=a;return t&&dt(o)}),Ht=T.default.div.withConfig({displayName:"SubActionRow__TopTimeline",componentId:"sc-7y8yzq-5"})(["padding-top:",";margin-top:",";width:","rem;background-color:",";border-top-left-radius:2px;border-top-right-radius:2px;"],a=>{let{theme:t}=a;return t.spaces[2]},a=>{let{theme:t}=a;return t.spaces[2]},4/16,a=>{let{theme:t}=a;return t.colors.primary200}),Pt=a=>{let{childrenForm:t,isFormDisabled:o,recursiveLevel:s,pathToDataFromActionRow:l,propertyActions:i,parentName:p,propertyName:m}=a;const{formatMessage:h}=(0,te.useIntl)(),{modifiedData:b,onChangeParentCheckbox:S,onChangeSimpleCheckbox:L}=(0,be.$_)(),[M,K]=(0,e.useState)(null),N=x=>{K($=>$===x?null:x)},X=(0,e.useMemo)(()=>M?t.find(x=>{let{value:$}=x;return $===M}):null,[M,t]);return e.createElement(kt,null,e.createElement(Ht,null),t.map((x,$)=>{let{label:ee,value:se,required:ye,children:$e}=x;const Oe=$+1<t.length,Pe=Array.isArray($e),Ae=M===se;return e.createElement(Zt,{key:se,isVisible:Oe},e.createElement(Gt,null,e.createElement(hn,{color:"primary200"}),e.createElement(Z.Flex,{style:{flex:1}},e.createElement(En,{level:s,isActive:Ae,isCollapsable:Pe},e.createElement(xt,(0,pn.Z)({alignItems:"center",isCollapsable:Pe},Pe&&{onClick:()=>N(se),"aria-expanded":Ae,onKeyDown:Be=>{let{key:qe}=Be;return(qe==="Enter"||qe===" ")&&N(se)},tabIndex:0,role:"button"},{title:ee}),e.createElement(W.Typography,{ellipsis:!0},J()(ee)),ye&&e.createElement($t,null),e.createElement(ct,{$isActive:Ae}))),e.createElement(Z.Flex,{style:{flex:1}},i.map(Be=>{let{actionId:qe,label:tt,isActionRelatedToCurrentProperty:nt}=Be;if(!nt)return e.createElement(At,{key:qe});const Ke=[...l.split(".."),qe,"properties",m,...p.split(".."),se],gt=g()(b,Ke,!1);if(!$e)return e.createElement(Tt,{key:tt,justifyContent:"center",alignItems:"center"},e.createElement(ge.BaseCheckbox,{disabled:o||Vt,name:Ke.join(".."),"aria-label":h({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:`${p} ${ee} ${tt}`}),onValueChange:Rt=>{L({target:{name:Ke.join(".."),value:Rt}})},value:gt}));const{hasAllActionsSelected:ut,hasSomeActionsSelected:St}=Je(gt);return e.createElement(Tt,{key:tt,justifyContent:"center",alignItems:"center"},e.createElement(ge.BaseCheckbox,{key:tt,disabled:o||Vt,name:Ke.join(".."),"aria-label":h({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:`${p} ${ee} ${tt}`}),onValueChange:Rt=>{S({target:{name:Ke.join(".."),value:Rt}})},value:ut,indeterminate:St}))})))),X&&Ae&&e.createElement(I.Box,{paddingBottom:2},e.createElement(Pt,{isFormDisabled:o,parentName:`${p}..${se}`,pathToDataFromActionRow:l,propertyActions:i,propertyName:m,recursiveLevel:s+1,childrenForm:X.children})))}))};Pt.propTypes={childrenForm:r().array.isRequired,isFormDisabled:r().bool.isRequired,parentName:r().string.isRequired,pathToDataFromActionRow:r().string.isRequired,propertyActions:r().array.isRequired,propertyName:r().string.isRequired,recursiveLevel:r().number.isRequired};const d=(0,e.memo)(Pt),c=a=>a.reduce((o,s)=>(s.isActionRelatedToCurrentProperty&&o.push(s.actionId),o),[]),E=(a,t,o,s,l)=>{const p=c(a).reduce((m,h)=>{const b=[...o.split(".."),h,"properties",s,l],S=(0,v.get)(t,b,!1);return m[h]=S,m},{});return Je(p)},P=(()=>window&&window.strapi&&window.strapi.isEE?n(57779).Z:n(48496).Z)(),O=(0,T.default)(Z.Flex).withConfig({displayName:"ActionRow__Cell",componentId:"sc-4agenc-0"})(["width:",";position:relative;"],_),F=(0,T.default)(Z.Flex).withConfig({displayName:"ActionRow__Wrapper",componentId:"sc-4agenc-1"})(["height:",";flex:1;"," ",";"],w,a=>{let{isCollapsable:t,theme:o}=a;return t&&`
      ${ct} {
        display: block;
        color: ${o.colors.neutral100};
      }
      &:hover {
        ${dt(o)}
      }
  `},a=>{let{isActive:t,theme:o}=a;return t&&dt(o)}),A=a=>{let{childrenForm:t,label:o,isFormDisabled:s,name:l,required:i,pathToData:p,propertyActions:m,propertyName:h,isOdd:b}=a;const{formatMessage:S}=(0,te.useIntl)(),[L,M]=(0,e.useState)(null),{modifiedData:K,onChangeCollectionTypeLeftActionRowCheckbox:N,onChangeParentCheckbox:X,onChangeSimpleCheckbox:x}=(0,be.$_)(),$=L===l,ee=(0,e.useMemo)(()=>Array.isArray(t)?t:[],[t]),se=ee.length>0,ye=(0,e.useCallback)(()=>{se&&M(Ae=>Ae===l?null:l)},[se,l]),$e=Ae=>{let{target:{value:Be}}=Ae;N(p,h,l,Be)},{hasAllActionsSelected:Oe,hasSomeActionsSelected:Pe}=(0,e.useMemo)(()=>E(m,K,p,h,l),[m,K,p,h,l]);return e.createElement(e.Fragment,null,e.createElement(F,{alignItems:"center",isCollapsable:se,isActive:$,background:b?"neutral100":"neutral0"},e.createElement(Z.Flex,null,e.createElement(pt,{onChange:$e,onClick:ye,isCollapsable:se,isFormDisabled:s,label:o,someChecked:Pe,value:Oe,isActive:$},i&&e.createElement($t,null),e.createElement(ct,{$isActive:$})),e.createElement(Z.Flex,null,m.map(Ae=>{let{label:Be,isActionRelatedToCurrentProperty:qe,actionId:tt}=Ae;if(!qe)return e.createElement(At,{key:Be});const nt=[...p.split(".."),tt,"properties",h,l];if(!se){const St=g()(K,nt,!1);return e.createElement(O,{key:tt,justifyContent:"center",alignItems:"center"},e.createElement(ge.BaseCheckbox,{disabled:s||P,name:nt.join(".."),"aria-label":S({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:`${l} ${Be}`}),onValueChange:Rt=>{x({target:{name:nt.join(".."),value:Rt}})},value:St}))}const Ke=g()(K,nt,{}),{hasAllActionsSelected:gt,hasSomeActionsSelected:ut}=Je(Ke);return e.createElement(O,{key:Be,justifyContent:"center",alignItems:"center"},e.createElement(ge.BaseCheckbox,{disabled:s||P,name:nt.join(".."),onValueChange:St=>{X({target:{name:nt.join(".."),value:St}})},"aria-label":S({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:`${l} ${Be}`}),value:gt,indeterminate:ut}))})))),$&&e.createElement(d,{childrenForm:ee,isFormDisabled:s,parentName:l,pathToDataFromActionRow:p,propertyName:h,propertyActions:m,recursiveLevel:0}))};A.defaultProps={childrenForm:[],required:!1},A.propTypes={childrenForm:r().array,label:r().string.isRequired,isFormDisabled:r().bool.isRequired,name:r().string.isRequired,pathToData:r().string.isRequired,propertyActions:r().array.isRequired,propertyName:r().string.isRequired,required:r().bool,isOdd:r().bool.isRequired};const y=(0,e.memo)(A),D=T.default.div`
  display: inline-flex;
  flex-direction: column;
  min-width: 0;
`,Ce=({availableActions:a,childrenForm:t,isFormDisabled:o,label:s,pathToData:l,propertyName:i})=>{const p=(0,e.useMemo)(()=>tn(a,i),[a,i]);return e.createElement(D,null,e.createElement(on,{label:s,headers:p}),e.createElement(I.Box,null,t.map(({children:m,label:h,value:b,required:S},L)=>e.createElement(y,{childrenForm:m,key:b,label:h,isFormDisabled:o,name:b,required:S,propertyActions:p,pathToData:l,propertyName:i,isOdd:L%2===0}))))};Ce.propTypes={childrenForm:r().array.isRequired,availableActions:r().array.isRequired,isFormDisabled:r().bool.isRequired,label:r().string.isRequired,pathToData:r().string.isRequired,propertyName:r().string.isRequired};const Fe=Ce,Re=T.default.div`
  flex-direction: column;
  display: inline-flex;
  min-width: 100%;
  ${({theme:a,isActive:t})=>t&&`border: 1px solid ${a.colors.primary600};`}
`,_e=({allActions:a,contentTypeName:t,label:o,index:s,isActive:l,isFormDisabled:i,onClickToggleCollapse:p,pathToData:m,properties:h})=>{const b=(0,e.useCallback)(()=>{p(t)},[t,p]),S=(0,e.useMemo)(()=>Ut(a,t),[a,t]);return e.createElement(Re,{isActive:l},e.createElement(wt,{availableActions:S,isActive:l,isGrey:s%2===0,isFormDisabled:i,label:o,onClickToggle:b,pathToData:m}),l&&h.map(({label:L,value:M,children:K})=>e.createElement(Fe,{availableActions:S,childrenForm:K,isFormDisabled:i,label:L,pathToData:m,propertyName:M,key:M})))};_e.propTypes={allActions:r().array.isRequired,contentTypeName:r().string.isRequired,index:r().number.isRequired,isActive:r().bool.isRequired,isFormDisabled:r().bool.isRequired,label:r().string.isRequired,onClickToggleCollapse:r().func.isRequired,pathToData:r().string.isRequired,properties:r().array.isRequired};const et=_e,Ve=({actions:a,isFormDisabled:t,pathToData:o,subjects:s})=>{const[l,i]=(0,e.useState)(null),p=m=>{i(l===m?null:m)};return s.map(({uid:m,label:h,properties:b},S)=>e.createElement(et,{allActions:a,key:m,contentTypeName:m,label:h,isActive:l===m,isFormDisabled:t,index:S,onClickToggleCollapse:p,pathToData:`${o}..${m}`,properties:b}))};Ve.defaultProps={actions:[],subjects:[]},Ve.propTypes={actions:r().array.isRequired,isFormDisabled:r().bool.isRequired,pathToData:r().string.isRequired,subjects:r().arrayOf(r().shape({uid:r().string.isRequired,label:r().string.isRequired,properties:r().array.isRequired}))};const at=(0,e.memo)(Ve),Do=a=>a.filter(({subjects:t})=>t&&t.length);var Lo=Object.defineProperty,$n=Object.getOwnPropertySymbols,Mo=Object.prototype.hasOwnProperty,Io=Object.prototype.propertyIsEnumerable,Wn=(a,t,o)=>t in a?Lo(a,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[t]=o,Un=(a,t)=>{for(var o in t||(t={}))Mo.call(t,o)&&Wn(a,o,t[o]);if($n)for(var o of $n(t))Io.call(t,o)&&Wn(a,o,t[o]);return a};const Fo=a=>a.map(({actionId:t})=>t),Bo=(a,t)=>a.reduce((o,s)=>(Object.keys(t).forEach(l=>{const i=(0,v.get)(t,[l,s],{}),p={[l]:it(i)};o[s]?o[s]=Un(Un({},o[s]),p):o[s]=p}),o),{}),jo=(a,t)=>{const o=Fo(a),s=Bo(o,t);return Object.keys(s).reduce((i,p)=>(i[p]=Je(s[p]),i),{})},wo=(()=>window&&window.strapi&&window.strapi.isEE?n(26107).Z:n(39672).Z)(),No=(0,T.default)(Ee.Stack).withConfig({displayName:"GlobalActions__CenteredStack",componentId:"sc-1vxwsjr-0"})(["align-items:center;justify-content:center;width:",";flex-shrink:0;"],_),vn=a=>{let{actions:t,isFormDisabled:o,kind:s}=a;const{formatMessage:l}=(0,te.useIntl)(),{modifiedData:i,onChangeCollectionTypeGlobalActionCheckbox:p}=(0,be.$_)(),m=(0,e.useMemo)(()=>Do(t),[t]),h=(0,e.useMemo)(()=>jo(m,i[s]),[i,m,s]);return e.createElement(I.Box,{paddingBottom:4,paddingTop:6,style:{paddingLeft:Y}},e.createElement(Ee.Stack,{horizontal:!0,spacing:0},m.map(b=>{let{label:S,actionId:L}=b;return e.createElement(No,{key:L,spacing:3},e.createElement(W.Typography,{variant:"sigma",textColor:"neutral500"},l({id:`Settings.roles.form.permissions.${S.toLowerCase()}`,defaultMessage:S})),e.createElement(ge.BaseCheckbox,{disabled:o||wo,onValueChange:M=>{p(s,L,M)},name:L,"aria-label":l({id:"Settings.permissions.select-all-by-permission",defaultMessage:"Select all {label} permissions"},{label:l({id:`Settings.roles.form.permissions.${S.toLowerCase()}`,defaultMessage:S})}),value:g()(h,[L,"hasAllActionsSelected"],!1),indeterminate:g()(h,[L,"hasSomeActionsSelected"],!1)}))})))};vn.defaultProps={actions:[]},vn.propTypes={actions:r().arrayOf(r().shape({label:r().string.isRequired,actionId:r().string.isRequired,subjects:r().array.isRequired})),isFormDisabled:r().bool.isRequired,kind:r().string.isRequired};const $o=(0,e.memo)(vn),Wo=(0,T.default)(I.Box)`
  overflow-x: auto;
`,zn=({isFormDisabled:a,kind:t,layout:{actions:o,subjects:s}})=>{const l=pe()([...s],"label");return e.createElement(Wo,{background:"neutral0"},e.createElement($o,{actions:o,kind:t,isFormDisabled:a}),e.createElement(at,{actions:o,isFormDisabled:a,pathToData:t,subjects:l}))};zn.propTypes={isFormDisabled:r().bool.isRequired,kind:r().string.isRequired,layout:r().shape({actions:r().array,subjects:r().arrayOf(r().shape({uid:r().string.isRequired,label:r().string.isRequired,properties:r().array.isRequired}))}).isRequired};const Vn=(0,e.memo)(zn);var Uo=n(40448);const Gn=({children:a,value:t})=>e.createElement(Uo.$l.Provider,{value:t},a);Gn.propTypes={children:r().node.isRequired,value:r().exact({availableConditions:r().array.isRequired,modifiedData:r().object.isRequired,onChangeCollectionTypeLeftActionRowCheckbox:r().func.isRequired,onChangeConditions:r().func.isRequired,onChangeSimpleCheckbox:r().func.isRequired,onChangeParentCheckbox:r().func.isRequired,onChangeCollectionTypeGlobalActionCheckbox:r().func.isRequired}).isRequired};const zo=Gn;var Cn=n(47949),kn=n(39272),Zn=n(43499),Vo=Object.defineProperty,Go=Object.defineProperties,ko=Object.getOwnPropertyDescriptors,Hn=Object.getOwnPropertySymbols,Zo=Object.prototype.hasOwnProperty,Ho=Object.prototype.propertyIsEnumerable,Kn=(a,t,o)=>t in a?Vo(a,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[t]=o,Ko=(a,t)=>{for(var o in t||(t={}))Zo.call(t,o)&&Kn(a,o,t[o]);if(Hn)for(var o of Hn(t))Ho.call(t,o)&&Kn(a,o,t[o]);return a},Xo=(a,t)=>Go(a,ko(t));const Yo=(a,t,o)=>a.map(s=>{const l=[...o,s.action,"properties","enabled"],i=(0,v.get)(t,l,!1),p=(0,v.get)(t,[...o,s.action,"conditions"],{}),m=lt(p).some(h=>h);return Xo(Ko({},s),{isDisplayed:i,checkboxName:l.join(".."),hasSomeActionsSelected:i,value:i,hasConditions:m,label:s.displayName,actionId:s.action,pathToConditionsObject:[...o,s.action]})}),Qo=a=>{const t=Object.entries(a).reduce((s,l)=>{const[i,{conditions:p}]=l;return s[i]=p,s},{});return lt(t).some(s=>s)},bn=(()=>window&&window.strapi&&window.strapi.isEE?n(45667).Z:n(99399).Z)(),Jo=T.default.div.withConfig({displayName:"SubCategory__Border",componentId:"sc-akgczm-0"})(["flex:1;align-self:center;border-top:1px solid ",";"],a=>{let{theme:t}=a;return t.colors.neutral150}),qo=T.default.div.withConfig({displayName:"SubCategory__CheckboxWrapper",componentId:"sc-akgczm-1"})(["position:relative;word-break:keep-all;",""],a=>{let{hasConditions:t,disabled:o,theme:s}=a;return t&&`
    &:before {
      content: '';
      position: absolute;
      top: ${-4/16}rem;
      left: ${-8/16}rem;
      width: ${6/16}rem;
      height: ${6/16}rem;
      border-radius: ${20/16}rem;
      background: ${o?s.colors.neutral100:s.colors.primary600};
    }
  `}),Xn=a=>{let{categoryName:t,isFormDisabled:o,subCategoryName:s,actions:l,pathToData:i}=a;const[p,m]=(0,e.useState)(!1),{modifiedData:h,onChangeParentCheckbox:b,onChangeSimpleCheckbox:S}=(0,be.$_)(),{formatMessage:L}=(0,te.useIntl)(),M=g()(h,i,{}),K=(0,e.useMemo)(()=>Object.keys(M).reduce((ye,$e)=>(ye[$e]=it(M[$e]),ye),{}),[M]),{hasAllActionsSelected:N,hasSomeActionsSelected:X}=Je(K),x=()=>{m(ye=>!ye)},$=()=>{m(!1)},ee=Yo(l,h,i),se=Qo(g()(h,[...i],{}));return e.createElement(e.Fragment,null,e.createElement(I.Box,null,e.createElement(Z.Flex,{justifyContent:"space-between",alignItems:"center"},e.createElement(I.Box,{paddingRight:4},e.createElement(W.Typography,{variant:"sigma",textColor:"neutral600"},s)),e.createElement(Jo,null),e.createElement(I.Box,{paddingLeft:4},e.createElement(Zn.Checkbox,{name:i.join(".."),disabled:o||bn,onValueChange:ye=>{b({target:{name:i.join(".."),value:ye}})},indeterminate:X,value:N},L({id:"app.utils.select-all",defaultMessage:"Select all"})))),e.createElement(Z.Flex,{paddingTop:6,paddingBottom:6},e.createElement(kn.Grid,{gap:2,style:{flex:1}},ee.map(ye=>{let{checkboxName:$e,value:Oe,action:Pe,displayName:Ae,hasConditions:Be}=ye;return e.createElement(kn.GridItem,{col:3,key:Pe},e.createElement(qo,{disabled:o||bn,hasConditions:Be},e.createElement(Zn.Checkbox,{name:$e,disabled:o||bn,onValueChange:qe=>{S({target:{name:$e,value:qe}})},value:Oe},Ae)))})),e.createElement(Ue,{hasConditions:se,onClick:x}))),p&&e.createElement(Ot,{headerBreadCrumbs:[t,s],actions:ee,isFormDisabled:o,onClosed:$,onToggle:x}))};Xn.propTypes={actions:r().array.isRequired,categoryName:r().string.isRequired,isFormDisabled:r().bool.isRequired,subCategoryName:r().string.isRequired,pathToData:r().array.isRequired};const _o=Xn,Tn=({childrenForm:a,kind:t,name:o,isOpen:s,isFormDisabled:l,isWhite:i,onOpenCategory:p,pathToData:m})=>{const{formatMessage:h}=(0,te.useIntl)(),b=()=>{p(o)},S=(0,e.useMemo)(()=>o.split("::").pop(),[o]);return e.createElement(Cn.Accordion,{expanded:s,onToggle:b,id:`accordion-${o}`,variant:i?"primary":"secondary"},e.createElement(Cn.AccordionToggle,{title:J()(S),description:`${h({id:"Settings.permissions.category"},{category:S})} ${t==="plugins"?"plugin":t}`}),e.createElement(Cn.AccordionContent,null,e.createElement(I.Box,{padding:6},a.map(({actions:L,subCategoryName:M,subCategoryId:K})=>e.createElement(_o,{key:M,actions:L,categoryName:S,isFormDisabled:l,subCategoryName:M,pathToData:[...m,K]})))))};Tn.defaultProps={},Tn.propTypes={childrenForm:r().array.isRequired,isOpen:r().bool.isRequired,isFormDisabled:r().bool.isRequired,isWhite:r().bool.isRequired,kind:r().string.isRequired,name:r().string.isRequired,onOpenCategory:r().func.isRequired,pathToData:r().array.isRequired};const ea=Tn,Yn=({isFormDisabled:a,kind:t,layout:o})=>{const[s,l]=(0,e.useState)(null),i=p=>{l(p===s?null:p)};return e.createElement(I.Box,{padding:6,background:"neutral0"},o.map(({category:p,categoryId:m,childrenForm:h},b)=>e.createElement(ea,{key:p,childrenForm:h,kind:t,isFormDisabled:a,isOpen:s===p,isWhite:b%2===1,name:p,onOpenCategory:i,pathToData:[t,m]})))};Yn.propTypes={isFormDisabled:r().bool.isRequired,kind:r().string.isRequired,layout:r().arrayOf(r().shape({category:r().string.isRequired,categoryId:r().string.isRequired,childrenForm:r().arrayOf(r().shape({actions:r().array.isRequired})).isRequired}).isRequired).isRequired};const Qn=Yn,Jn=(a,t,o)=>a.find(s=>s.action===t&&s.subject===o);var ta=Object.defineProperty,na=Object.defineProperties,oa=Object.getOwnPropertyDescriptors,qn=Object.getOwnPropertySymbols,aa=Object.prototype.hasOwnProperty,sa=Object.prototype.propertyIsEnumerable,_n=(a,t,o)=>t in a?ta(a,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[t]=o,eo=(a,t)=>{for(var o in t||(t={}))aa.call(t,o)&&_n(a,o,t[o]);if(qn)for(var o of qn(t))sa.call(t,o)&&_n(a,o,t[o]);return a},to=(a,t)=>na(a,oa(t));const no=(a,t=[])=>a.reduce((o,s)=>(o[s.id]=t.indexOf(s.id)!==-1,o),{}),oo=({children:a},t,o="")=>a.reduce((s,l)=>{if(l.children)return to(eo({},s),{[l.value]:oo(l,t,`${o}${l.value}.`)});const i=t.indexOf(`${o}${l.value}`)!==-1;return s[l.value]=i,s},{}),ra=(a,t,o)=>a.reduce((s,l)=>{const i=t.properties.find(({value:p})=>p===l);if(i){const p=(0,v.get)(o,["properties",i.value],[]),m=oo(i,p);s.properties[l]=m}return s},{properties:{}}),la=(a,t)=>t.reduce((o,s)=>{const l=a.find(({uid:i})=>i===s)||null;return l&&(o[s]=l),o},{}),ao=({subjects:a},t,o,s=[])=>t.reduce((l,i)=>{const p=i.subjects,m=la(a,p);if((0,v.isEmpty)(m))return l;const h=Object.keys(m).reduce((b,S)=>{const{actionId:L,applyToProperties:M}=i,X=m[S].properties.map(({value:se})=>se).every(se=>(M||[]).indexOf(se)===-1),x=Jn(s,L,S),$=no(o,(0,v.get)(x,"conditions",[]));if((0,v.isEmpty)(M)||X)return(0,v.set)(b,[S,L],{properties:{enabled:x!==void 0},conditions:$}),b;const ee=ra(M,m[S],x);return(0,v.set)(b,[S,L],to(eo({},ee),{conditions:$})),b},{});return(0,v.merge)(l,h)},{}),ia=(a,t,o)=>a.reduce((s,l)=>{const i=Jn(o,l.action,null);return s[l.action]={properties:{enabled:i!==void 0},conditions:no(t,(0,v.get)(i,"conditions",[]))},s},{}),ca=(a,t,o)=>a.reduce((s,l)=>(s[l.subCategoryId]=ia(l.actions,t,o),s),{}),so=(a,t,o=[])=>a.reduce((s,{categoryId:l,childrenForm:i})=>{const p=ca(i,t,o);return s[l]=p,s},{}),ro=a=>a.split(" ").join("-"),lo=(a,t)=>(0,v.chain)(a).groupBy(t).map((o,s)=>({category:s,categoryId:ro(s),childrenForm:(0,v.chain)(o).groupBy("subCategory").map((l,i)=>({subCategoryName:i,subCategoryId:ro(i),actions:l})).value()})).value(),da=(a,t)=>{const{conditions:o,sections:{collectionTypes:s,singleTypes:l,plugins:i,settings:p}}=a,m={collectionTypes:s,singleTypes:l,plugins:lo(i,"plugin"),settings:lo(p,"category")},h={collectionTypes:ao(s,s.actions||[],o,t),singleTypes:ao(l,l.actions||[],o,t),plugins:so(m.plugins,o,t),settings:so(m.settings,o,t)};return{initialData:h,modifiedData:h,layouts:m}};var ua=Object.defineProperty,pa=Object.defineProperties,ma=Object.getOwnPropertyDescriptors,io=Object.getOwnPropertySymbols,ga=Object.prototype.hasOwnProperty,fa=Object.prototype.propertyIsEnumerable,co=(a,t,o)=>t in a?ua(a,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[t]=o,Pn=(a,t)=>{for(var o in t||(t={}))ga.call(t,o)&&co(a,o,t[o]);if(io)for(var o of io(t))fa.call(t,o)&&co(a,o,t[o]);return a},Sn=(a,t)=>pa(a,ma(t));const uo=a=>Object.keys(a).reduce((t,o)=>{const s=a[o];if((0,v.isObject)(s)&&!(0,v.has)(s,"conditions"))return Sn(Pn({},t),{[o]:uo(s)});if((0,v.isObject)(s)&&(0,v.has)(s,"conditions")&&!lt((0,v.omit)(s,"conditions")).some(i=>i)){const i=Object.keys(s.conditions).reduce((p,m)=>(p[m]=!1,p),{});return Sn(Pn({},t),{[o]:Sn(Pn({},s),{conditions:i})})}return t[o]=s,t},{}),Rn=uo;var ya=Object.defineProperty,ha=Object.defineProperties,Ea=Object.getOwnPropertyDescriptors,po=Object.getOwnPropertySymbols,va=Object.prototype.hasOwnProperty,Ca=Object.prototype.propertyIsEnumerable,mo=(a,t,o)=>t in a?ya(a,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[t]=o,ba=(a,t)=>{for(var o in t||(t={}))va.call(t,o)&&mo(a,o,t[o]);if(po)for(var o of po(t))Ca.call(t,o)&&mo(a,o,t[o]);return a},Ta=(a,t)=>ha(a,Ea(t));const go=(a,t)=>Object.keys(a).reduce((o,s)=>{const l=a[s];return s==="conditions"?(o[s]=l,o):(0,v.isObject)(l)?Ta(ba({},o),{[s]:go(l,t)}):(o[s]=t,o)},{}),Kt=go;var Pa=Object.defineProperty,Sa=Object.defineProperties,Ra=Object.getOwnPropertyDescriptors,fo=Object.getOwnPropertySymbols,Oa=Object.prototype.hasOwnProperty,Aa=Object.prototype.propertyIsEnumerable,yo=(a,t,o)=>t in a?Pa(a,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[t]=o,xa=(a,t)=>{for(var o in t||(t={}))Oa.call(t,o)&&yo(a,o,t[o]);if(fo)for(var o of fo(t))Aa.call(t,o)&&yo(a,o,t[o]);return a},Da=(a,t)=>Sa(a,Ra(t));const La={initialData:{},modifiedData:{},layouts:{}},Ma=(a,t)=>(0,G.default)(a,o=>{switch(t.type){case"ON_CHANGE_COLLECTION_TYPE_GLOBAL_ACTION_CHECKBOX":{const{collectionTypeKind:s,actionId:l,value:i}=t,p=["modifiedData",s];Object.keys((0,v.get)(a,p)).forEach(m=>{const h=(0,v.get)(a,[...p,m,l],void 0);if(h){let b=Kt(h,i);if(!i&&b.conditions){const S=Kt(b.conditions,!1);b=Da(xa({},b),{conditions:S})}(0,v.set)(o,[...p,m,l],b)}});break}case"ON_CHANGE_COLLECTION_TYPE_ROW_LEFT_CHECKBOX":{const{pathToCollectionType:s,propertyName:l,rowName:i,value:p}=t;let m=(0,v.cloneDeep)(a.modifiedData);const h=s.split(".."),b=(0,v.get)(m,h,{});Object.keys(b).forEach(S=>{if((0,v.has)(b[S],`properties.${l}`)){const L=(0,v.get)(b,[S,"properties",l,i]),M=[...h,S,"properties",l,i];if(!(0,v.isObject)(L))(0,v.set)(m,M,p);else{const K=Kt(L,p);(0,v.set)(m,M,K)}}}),p||(m=Rn(m)),(0,v.set)(o,"modifiedData",m);break}case"ON_CHANGE_CONDITIONS":{Object.entries(t.conditions).forEach(s=>{const[l,i]=s;(0,v.set)(o,["modifiedData",...l.split(".."),"conditions"],i)});break}case"ON_CHANGE_SIMPLE_CHECKBOX":{let s=(0,v.cloneDeep)(a.modifiedData);(0,v.set)(s,[...t.keys.split("..")],t.value),t.value||(s=Rn(s)),(0,v.set)(o,"modifiedData",s);break}case"ON_CHANGE_TOGGLE_PARENT_CHECKBOX":{const{keys:s,value:l}=t,i=[...s.split("..")];let p=(0,v.cloneDeep)(a.modifiedData);const m=(0,v.get)(p,i,{}),h=Kt(m,l);(0,v.set)(p,i,h),l||(p=Rn(p)),(0,v.set)(o,["modifiedData"],p);break}case"RESET_FORM":{o.modifiedData=a.initialData;break}case"SET_FORM_AFTER_SUBMIT":{o.initialData=a.modifiedData;break}default:return o}}),On=a=>Object.entries(a).filter(([,t])=>t).map(([t])=>t),Ia=a=>{const[t,{conditions:o}]=a;return{action:t,subject:null,conditions:On(o),properties:{}}},Fa=a=>Object.values(a).reduce((t,o)=>{const s=Object.entries(o).reduce((l,i)=>{const[,{properties:{enabled:p}}]=i;if(!p)return l;const m=Ia(i);return l.push(m),l},[]);return[...t,...s]},[]),ho=a=>Object.values(a).reduce((t,o)=>{const s=Fa(o);return[...t,...s]},[]),Eo=(a,t="")=>Object.entries(a).reduce((o,s)=>{const[l,i]=s;return(0,v.isObject)(i)?[...o,...Eo(i,`${t}${l}.`)]:(i&&!(0,v.isObject)(i)&&o.push(`${t}${l}`),o)},[]),Ba=(a,t,{conditions:o,properties:s})=>Object.entries(s).reduce((l,i)=>{const[p,m]=i;return l.properties[p]=Eo(m),l},{action:a,subject:t,conditions:On(o),properties:{}}),ja=(a,t,{conditions:o})=>({action:a,subject:t,properties:{},conditions:On(o)}),wa=(a,t)=>Object.entries(t).reduce((s,l)=>{const[i,p]=l;if(!lt(p).some(b=>b))return s;if(!(0,v.has)(p,"properties.enabled")){const b=Ba(i,a,p);return[...s,b]}if(!p.properties.enabled)return s;const h=ja(i,a,p);return s.push(h),s},[]),vo=a=>Object.entries(a).reduce((o,s)=>{const[l,i]=s,p=wa(l,i);return[...o,...p]},[]),Na=a=>{const t=ho(a.plugins),o=ho(a.settings),s=vo(a.collectionTypes),l=vo(a.singleTypes);return[...t,...o,...s,...l]},$a=[{labelId:"app.components.LeftMenuLinkContainer.collectionTypes",defaultMessage:"Collection Types",id:"collectionTypes"},{labelId:"app.components.LeftMenuLinkContainer.singleTypes",id:"singleTypes",defaultMessage:"Single Types"},{labelId:"app.components.LeftMenuLinkContainer.plugins",defaultMessage:"Plugins",id:"plugins"},{labelId:"app.components.LeftMenuLinkContainer.settings",defaultMessage:"Settings",id:"settings"}];var Wa=Object.defineProperty,Co=Object.getOwnPropertySymbols,Ua=Object.prototype.hasOwnProperty,za=Object.prototype.propertyIsEnumerable,bo=(a,t,o)=>t in a?Wa(a,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[t]=o,To=(a,t)=>{for(var o in t||(t={}))Ua.call(t,o)&&bo(a,o,t[o]);if(Co)for(var o of Co(t))za.call(t,o)&&bo(a,o,t[o]);return a};const An=(0,e.forwardRef)(({layout:a,isFormDisabled:t,permissions:o},s)=>{const[{initialData:l,layouts:i,modifiedData:p},m]=(0,e.useReducer)(Ma,La,()=>da(a,o)),{formatMessage:h}=(0,te.useIntl)();(0,e.useImperativeHandle)(s,()=>({getPermissions:()=>{const N=(0,U.difference)(l.collectionTypes,p.collectionTypes),X=(0,U.difference)(l.singleTypes,p.singleTypes),x=To(To({},N),X);let $;return xe()(x)?$=!1:$=Object.values(x).some(ee=>Object.values(ee).some(se=>de()(se,"conditions"))),{permissionsToSend:Na(p),didUpdateConditions:$}},resetForm:()=>{m({type:"RESET_FORM"})},setFormAfterSubmit:()=>{m({type:"SET_FORM_AFTER_SUBMIT"})}}));const b=(N,X,x,$)=>{m({type:"ON_CHANGE_COLLECTION_TYPE_ROW_LEFT_CHECKBOX",pathToCollectionType:N,propertyName:X,rowName:x,value:$})},S=(N,X,x)=>{m({type:"ON_CHANGE_COLLECTION_TYPE_GLOBAL_ACTION_CHECKBOX",collectionTypeKind:N,actionId:X,value:x})},L=N=>{m({type:"ON_CHANGE_CONDITIONS",conditions:N})},M=(0,e.useCallback)(({target:{name:N,value:X}})=>{m({type:"ON_CHANGE_SIMPLE_CHECKBOX",keys:N,value:X})},[]),K=(0,e.useCallback)(({target:{name:N,value:X}})=>{m({type:"ON_CHANGE_TOGGLE_PARENT_CHECKBOX",keys:N,value:X})},[]);return e.createElement(zo,{value:{availableConditions:a.conditions,modifiedData:p,onChangeConditions:L,onChangeSimpleCheckbox:M,onChangeParentCheckbox:K,onChangeCollectionTypeLeftActionRowCheckbox:b,onChangeCollectionTypeGlobalActionCheckbox:S}},e.createElement(B.TabGroup,{id:"tabs",label:h({id:"Settings.permissions.users.tabs.label",defaultMessage:"Tabs Permissions"})},e.createElement(B.Tabs,null,$a.map(N=>e.createElement(B.Tab,{key:N.id},h({id:N.labelId,defaultMessage:N.defaultMessage})))),e.createElement(B.TabPanels,{style:{position:"relative"}},e.createElement(B.TabPanel,null,e.createElement(Vn,{layout:i.collectionTypes,kind:"collectionTypes",isFormDisabled:t})),e.createElement(B.TabPanel,null,e.createElement(Vn,{layout:i.singleTypes,kind:"singleTypes",isFormDisabled:t})),e.createElement(B.TabPanel,null,e.createElement(Qn,{layout:i.plugins,kind:"plugins",isFormDisabled:t})),e.createElement(B.TabPanel,null,e.createElement(Qn,{layout:i.settings,kind:"settings",isFormDisabled:t})))))});An.defaultProps={permissions:[],layout:{conditions:[],sections:{collectionTypes:{},singleTypes:{actions:[]},settings:[],plugins:[]}}},An.propTypes={layout:r().object,isFormDisabled:r().bool.isRequired,permissions:r().array};const Va=(0,e.memo)(An)},99399:(k,C,n)=>{n.d(C,{Z:()=>f});const f=!0},75365:(k,C,n)=>{n.d(C,{Z:()=>e});const e=()=>"todo empty role"},56894:(k,C,n)=>{n.d(C,{Z:()=>be});var e=n(53547),f=n(45697),r=n.n(f),U=n(94117),B=n.n(U),le=n(40264),de=n.n(le),ue=n(43546),xe=n.n(ue),te=n(33483),I=n.n(te),T=n(49549),V=n.n(T),pe=n(68547),oe=n.n(pe),ne=n(97132),Ge=n.n(ne),We=Object.defineProperty,ge=Object.getOwnPropertySymbols,Z=Object.prototype.hasOwnProperty,Xe=Object.prototype.propertyIsEnumerable,g=(he,ce,re)=>ce in he?We(he,ce,{enumerable:!0,configurable:!0,writable:!0,value:re}):he[ce]=re,De=(he,ce)=>{for(var re in ce||(ce={}))Z.call(ce,re)&&g(he,re,ce[re]);if(ge)for(var re of ge(ce))Xe.call(ce,re)&&g(he,re,ce[re]);return he};const je=({id:he,name:ce,description:re,usersCount:ke,icons:Le})=>{const{formatMessage:Ue}=(0,ne.useIntl)(),Ze=Ue({id:"Roles.RoleRow.user-count",defaultMessage:"{number, plural, =0 {#  user} one {#  user} other {# users}}"},{number:ke});return e.createElement(ue.Tr,De({key:he},(0,pe.onRowClick)({fn:Le[1].onClick})),e.createElement(ue.Td,{maxWidth:(0,pe.pxToRem)(130)},e.createElement(te.Typography,{ellipsis:!0,textColor:"neutral800"},ce)),e.createElement(ue.Td,{maxWidth:(0,pe.pxToRem)(250)},e.createElement(te.Typography,{ellipsis:!0,textColor:"neutral800"},re)),e.createElement(ue.Td,null,e.createElement(te.Typography,{textColor:"neutral800"},Ze)),e.createElement(ue.Td,null,e.createElement(le.Flex,De({justifyContent:"flex-end"},pe.stopPropagation),Le.map((Ee,we)=>Ee?e.createElement(U.Box,{key:Ee.label,paddingLeft:we===0?0:1},e.createElement(T.IconButton,{onClick:Ee.onClick,label:Ee.label,noBorder:!0,icon:Ee.icon})):null))))};je.propTypes={id:r().number.isRequired,name:r().string.isRequired,description:r().string.isRequired,usersCount:r().number.isRequired,icons:r().array.isRequired};const be=je},8114:(k,C,n)=>{n.d(C,{Z:()=>He});var e=n(53547),f=n(68547),r=n(92699),U=n(63852),B=n(89326),le=n.n(B),de=n(62982),ue=n.n(de),xe=n(56204),te=n.n(xe),I=n(54279),T=n.n(I),V=n(64459),pe=n(35395),oe=n(43546),ne=n(33483),Ge=n(80117),We=n(19631),ge=n(97132),Z=n(49656),Xe=n(56894),g=n(75365),De=n(45697),je=n.n(De),be=n(78384),he=n(54451),ce=n(15577),re=n(49549),ke=n(22499),Le=n(94117),Ue=n(40264),Ze=n(9524),Ee=n(74657),we=n.n(Ee),st=n(7228),W=n.n(st);const G=n.p+"c3de6118ef47086ad05c.png",ie=n.p+"bd81ba6c07827282255d.png",R=be.default.div`
  position: absolute;
  z-index: 3;
  inset: 0;
  background: ${({theme:j})=>(0,f.setHexOpacity)(j.colors.neutral800,.2)};
  padding: 0 ${({theme:j})=>j.spaces[8]};
`,ae=(0,be.default)(Ue.Flex)`
  position: relative;
  max-width: ${830/16}rem;
  height: ${415/16}rem;
  margin: 0 auto;
  overflow: hidden;
  margin-top: 10%;
  padding-left: ${64/16}rem;

  img:first-of-type {
    position: absolute;
    right: 0;
    top: 0;
    max-width: ${360/16}rem;
  }

  img:not(:first-of-type) {
    width: ${130/16}rem;
    margin-left: 12%;
    margin-right: ${20/16}rem;
    z-index: 0;
  }
`,J=(0,be.default)(Ze.Stack)`
  align-items: flex-start;
  max-width: ${400/16}rem;
  z-index: 0;
`,q=(0,be.default)(Le.Box)`
  position: absolute;
  right: ${({theme:j})=>j.spaces[4]};
  top: ${({theme:j})=>j.spaces[4]};
`,_=({onClose:j,isOpen:me})=>{(0,f.useLockScroll)(me);const{formatMessage:z}=(0,ge.useIntl)();return me?e.createElement(he.Portal,null,e.createElement(R,{onClick:j},e.createElement(ce.FocusTrap,{onEscape:j},e.createElement(ae,{onClick:H=>H.stopPropagation(),"aria-labelledby":"upgrade-plan",background:"neutral0",hasRadius:!0},e.createElement("img",{src:G,alt:"air-balloon"}),e.createElement(q,null,e.createElement(re.IconButton,{onClick:j,"aria-label":"Close",icon:e.createElement(W(),null)})),e.createElement(J,{spacing:6},e.createElement(ne.Typography,{fontWeight:"bold",textColor:"primary600"},z({id:"app.components.UpgradePlanModal.text-ce",defaultMessage:"COMMUNITY EDITION"})),e.createElement(Ze.Stack,{spacing:2},e.createElement(ne.Typography,{variant:"alpha",as:"h2",id:"upgrade-plan"},z({id:"app.components.UpgradePlanModal.limit-reached",defaultMessage:"You have reached the limit"})),e.createElement(ne.Typography,null,z({id:"app.components.UpgradePlanModal.text-power",defaultMessage:"Unlock the full power of Strapi by upgrading your plan to the Enterprise Edition"}))),e.createElement(ke.LinkButton,{href:"https://strapi.io/pricing-self-hosted",isExternal:!0,endIcon:e.createElement(we(),null)},z({id:"app.components.UpgradePlanModal.button",defaultMessage:"Learn more"}))),e.createElement("img",{src:ie,alt:"upgrade-arrow"}))))):null};_.propTypes={onClose:je().func.isRequired,isOpen:je().bool.isRequired};const Y=_;var w=n(32104);const ve=()=>{const{roles:j,isLoading:me}=(0,w.bF)(),z=(0,f.useQuery)(),H=decodeURIComponent(z.get("_q")||""),Se=(0,U.ZP)(j,H,{keys:["name","description"]});return{isLoading:me,sortedRoles:Se}},Me=()=>{const{formatMessage:j}=(0,ge.useIntl)(),[me,z]=(0,e.useState)(!1),{trackUsage:H}=(0,f.useTracking)(),{push:Se}=(0,Z.useHistory)(),Ie=(0,e.useCallback)(Te=>{Se(`/settings/roles/${Te}`)},[Se]),Ne=(0,e.useCallback)(()=>{z(Te=>!Te)},[]),Q=(0,e.useCallback)(()=>{H("didShowRBACUpgradeModal"),z(!0)},[H]),fe=(0,e.useCallback)(Te=>[{onClick:Ne,label:j({id:"app.utils.duplicate",defaultMessage:"Duplicate"}),icon:e.createElement(T(),null)},{onClick:()=>Ie(Te.id),label:j({id:"app.utils.edit",defaultMessage:"Edit"}),icon:e.createElement(te(),null)},{onClick:Ne,label:j({id:"global.delete",defaultMessage:"Delete"}),icon:e.createElement(ue(),null)}],[j,Ne,Ie]);return{isModalOpen:me,handleToggleModalForCreatingRole:Q,handleToggle:Ne,getIcons:fe}},ze=()=>{const{formatMessage:j}=(0,ge.useIntl)();(0,f.useFocusWhenNavigate)();const{sortedRoles:me,isLoading:z}=ve(),{isModalOpen:H,handleToggle:Se,handleToggleModalForCreatingRole:Ie,getIcons:Ne}=Me(),Q=me.length+1,fe=5;return e.createElement(Ge.Main,null,e.createElement(f.SettingsPageTitle,{name:"Roles"}),e.createElement(pe.HeaderLayout,{primaryAction:e.createElement(V.Button,{onClick:Ie,startIcon:e.createElement(le(),null),size:"L"},j({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})),title:j({id:"global.roles",defaultMessage:"roles"}),subtitle:j({id:"Settings.roles.list.description",defaultMessage:"List of roles"})}),e.createElement(pe.ContentLayout,null,e.createElement(oe.Table,{colCount:fe,rowCount:Q,footer:e.createElement(oe.TFooter,{onClick:Ie,icon:e.createElement(le(),null)},j({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"}))},e.createElement(oe.Thead,null,e.createElement(oe.Tr,null,e.createElement(oe.Th,null,e.createElement(ne.Typography,{variant:"sigma",textColor:"neutral600"},j({id:"global.name",defaultMessage:"Name"}))),e.createElement(oe.Th,null,e.createElement(ne.Typography,{variant:"sigma",textColor:"neutral600"},j({id:"global.description",defaultMessage:"Description"}))),e.createElement(oe.Th,null,e.createElement(ne.Typography,{variant:"sigma",textColor:"neutral600"},j({id:"global.users",defaultMessage:"Users"}))),e.createElement(oe.Th,null,e.createElement(We.VisuallyHidden,null,j({id:"global.actions",defaultMessage:"Actions"}))))),e.createElement(oe.Tbody,null,me==null?void 0:me.map(Te=>e.createElement(Xe.Z,{key:Te.id,id:Te.id,name:Te.name,description:Te.description,usersCount:Te.usersCount,icons:Ne(Te)})))),!Q&&!z&&e.createElement(g.Z,null)),e.createElement(Y,{isOpen:H,onClose:Se}))},He=()=>e.createElement(f.CheckPagePermissions,{permissions:r.Z.settings.roles.main},e.createElement(ze,null))},73258:(k,C,n)=>{n.d(C,{Z:()=>f});const f=[]},18290:(k,C,n)=>{n.d(C,{Z:()=>st});var e=n(53547),f=n(30381),r=n.n(f),U=n(68547),B=n(94117),le=n(64459),de=n(35395),ue=n(39272),xe=n(80117),te=n(40264),I=n(9524),T=n(33483),V=n(99136),pe=n(78607),oe=n(87760),ne=n.n(oe),Ge=n(80831),We=n(27361),ge=n.n(We),Z=n(41609),Xe=n.n(Z),g=n(97132),De=n(49656),je=n(78384),be=n(79160),he=n(32104),ce=n(92699),re=n(53209);const Le=re.Ry().shape({name:re.Z_().required(U.translatedErrors.required),description:re.Z_().required(U.translatedErrors.required)});var Ue=n(25108),Ze=(W,G,ie)=>new Promise((R,ae)=>{var J=Y=>{try{_(ie.next(Y))}catch(w){ae(w)}},q=Y=>{try{_(ie.throw(Y))}catch(w){ae(w)}},_=Y=>Y.done?R(Y.value):Promise.resolve(Y.value).then(J,q);_((ie=ie.apply(W,G)).next())});const Ee=je.default.div`
  border: 1px solid ${({theme:W})=>W.colors.primary200};
  background: ${({theme:W})=>W.colors.primary100};
  padding: ${({theme:W})=>`${W.spaces[2]} ${W.spaces[4]}`};
  color: ${({theme:W})=>W.colors.primary600};
  border-radius: ${({theme:W})=>W.borderRadius};
  font-size: ${12/16}rem;
  font-width: bold;
`,we=()=>{const W=(0,U.useNotification)(),{lockApp:G,unlockApp:ie}=(0,U.useOverlayBlocker)(),{formatMessage:R}=(0,g.useIntl)(),[ae,J]=(0,e.useState)(!1),{replace:q}=(0,De.useHistory)(),_=(0,e.useRef)(),{trackUsage:Y}=(0,U.useTracking)(),w=(0,De.useRouteMatch)("/settings/roles/duplicate/:id"),ve=ge()(w,"params.id",null),{isLoading:Me,data:Ye}=(0,he.U_)(),{permissions:ze,isLoading:v}=(0,he.Dq)(ve),He=me=>{G(),J(!0),Y(ve?"willDuplicateRole":"willCreateNewRole"),Promise.resolve((0,U.request)("/admin/roles",{method:"POST",body:me})).then(z=>Ze(void 0,null,function*(){const{permissionsToSend:H}=_.current.getPermissions();return Y(ve?"didDuplicateRole":"didCreateNewRole"),z.data.id&&!Xe()(H)&&(yield(0,U.request)(`/admin/roles/${z.data.id}/permissions`,{method:"PUT",body:{permissions:H}})),z})).then(z=>{J(!1),W({type:"success",message:{id:"Settings.roles.created",defaultMessage:"created"}}),q(`/settings/roles/${z.data.id}`)}).catch(z=>{Ue.error(z),J(!1),W({type:"warning",message:{id:"notification.error"}})}).finally(()=>{ie()})},j=`${R({id:"Settings.roles.form.created",defaultMessage:"Created"})} ${r()().format("LL")}`;return e.createElement(xe.Main,null,e.createElement(U.SettingsPageTitle,{name:"Roles"}),e.createElement(Ge.Formik,{initialValues:{name:"",description:j},onSubmit:He,validationSchema:Le,validateOnChange:!1},({handleSubmit:me,values:z,errors:H,handleReset:Se,handleChange:Ie})=>e.createElement(U.Form,{noValidate:!0},e.createElement(e.Fragment,null,e.createElement(de.HeaderLayout,{primaryAction:e.createElement(I.Stack,{horizontal:!0,spacing:2},e.createElement(le.Button,{variant:"secondary",onClick:()=>{Se(),_.current.resetForm()},size:"L"},R({id:"app.components.Button.reset",defaultMessage:"Reset"})),e.createElement(le.Button,{onClick:me,loading:ae,size:"L"},R({id:"global.save",defaultMessage:"Save"}))),title:R({id:"Settings.roles.create.title",defaultMessage:"Create a role"}),subtitle:R({id:"Settings.roles.create.description",defaultMessage:"Define the rights given to the role"}),navigationAction:e.createElement(U.Link,{startIcon:e.createElement(ne(),null),to:"/settings/roles"},R({id:"global.back",defaultMessage:"Back"}))}),e.createElement(de.ContentLayout,null,e.createElement(I.Stack,{spacing:6},e.createElement(B.Box,{background:"neutral0",padding:6,shadow:"filterShadow",hasRadius:!0},e.createElement(I.Stack,{spacing:4},e.createElement(te.Flex,{justifyContent:"space-between"},e.createElement(B.Box,null,e.createElement(B.Box,null,e.createElement(T.Typography,{fontWeight:"bold"},R({id:"global.details",defaultMessage:"Details"}))),e.createElement(B.Box,null,e.createElement(T.Typography,{variant:"pi",textColor:"neutral600"},R({id:"Settings.roles.form.description",defaultMessage:"Name and description of the role"})))),e.createElement(Ee,null,R({id:"Settings.roles.form.button.users-with-role",defaultMessage:"{number, plural, =0 {# users} one {# user} other {# users}} with this role"},{number:0}))),e.createElement(ue.Grid,{gap:4},e.createElement(ue.GridItem,{col:6},e.createElement(V.TextInput,{name:"name",error:H.name&&R({id:H.name}),label:R({id:"global.name",defaultMessage:"Name"}),onChange:Ie,value:z.name})),e.createElement(ue.GridItem,{col:6},e.createElement(pe.Textarea,{label:R({id:"global.description",defaultMessage:"Description"}),name:"description",error:H.description&&R({id:H.description}),onChange:Ie},z.description))))),!Me&&!v?e.createElement(B.Box,{shadow:"filterShadow",hasRadius:!0},e.createElement(be.Z,{isFormDisabled:!1,ref:_,permissions:ze,layout:Ye})):e.createElement(B.Box,{background:"neutral0",padding:6,shadow:"filterShadow",hasRadius:!0},e.createElement(U.LoadingIndicatorPage,null))))))))},st=()=>e.createElement(U.CheckPagePermissions,{permissions:ce.Z.settings.roles.create},e.createElement(we,null))},15272:(k,C,n)=>{n.d(C,{Z:()=>f});const f=!1},57779:(k,C,n)=>{n.d(C,{Z:()=>f});const f=!1},73071:(k,C,n)=>{n.d(C,{Z:()=>f});const f=!1},43549:(k,C,n)=>{n.d(C,{Z:()=>f});const f=!1},26107:(k,C,n)=>{n.d(C,{Z:()=>f});const f=!1},45667:(k,C,n)=>{n.d(C,{Z:()=>f});const f=!1},28099:(k,C,n)=>{n.d(C,{Z:()=>W});var e=n(53547),f=n(68547),r=n(92699),U=n(89326),B=n.n(U),le=n(62982),de=n.n(le),ue=n(54279),xe=n.n(ue),te=n(56204),I=n.n(te),T=n(64459),V=n(35395),pe=n(19631),oe=n(80117),ne=n(43546),Ge=n(33483),We=n(96486),ge=n(63852),Z=n(97132),Xe=n(49656),g=n(63955),De=n(32104),je=n(75365),be=n(56894),he=n(8041);const ce={roleToDelete:null,showModalConfirmButtonLoading:!1,shouldRefetchData:!1},ke=(G,ie)=>(0,he.default)(G,R=>{switch(ie.type){case"ON_REMOVE_ROLES":{R.showModalConfirmButtonLoading=!0;break}case"ON_REMOVE_ROLES_SUCCEEDED":{R.shouldRefetchData=!0,R.roleToDelete=null;break}case"RESET_DATA_TO_DELETE":{R.shouldRefetchData=!1,R.roleToDelete=null,R.showModalConfirmButtonLoading=!1;break}case"SET_ROLE_TO_DELETE":{R.roleToDelete=ie.id;break}default:return R}});var Le=(G,ie,R)=>new Promise((ae,J)=>{var q=w=>{try{Y(R.next(w))}catch(ve){J(ve)}},_=w=>{try{Y(R.throw(w))}catch(ve){J(ve)}},Y=w=>w.done?ae(w.value):Promise.resolve(w.value).then(q,_);Y((R=R.apply(G,ie)).next())});const Ue=()=>{(0,f.useFocusWhenNavigate)();const{isLoading:G,allowedActions:{canCreate:ie,canDelete:R,canRead:ae,canUpdate:J}}=(0,f.useRBAC)(r.Z.settings.roles),{getData:q,roles:_,isLoading:Y}=(0,De.bF)(!1),[{query:w}]=(0,f.useQueryParams)(),ve=(w==null?void 0:w._q)||"",Me=(0,ge.ZP)(_,ve,{keys:["name","description"]});return(0,e.useEffect)(()=>{!G&&ae&&q()},[G,ae,q]),{isLoadingForPermissions:G,canCreate:ie,canDelete:R,canRead:ae,canUpdate:J,isLoading:Y,getData:q,sortedRoles:Me,roles:_}},Ze=({getData:G,canCreate:ie,canDelete:R,canUpdate:ae})=>{const{formatMessage:J}=(0,Z.useIntl)(),q=(0,f.useNotification)(),[_,Y]=(0,e.useState)(!1),{push:w}=(0,Xe.useHistory)(),[{selectedRoles:ve,showModalConfirmButtonLoading:Me,roleToDelete:Ye},ze]=(0,e.useReducer)(ke,ce),v=()=>Le(void 0,null,function*(){try{ze({type:"ON_REMOVE_ROLES"}),yield g.be.post("/admin/roles/batch-delete",{ids:[Ye]}),yield G(),ze({type:"RESET_DATA_TO_DELETE"})}catch(Q){const fe=(0,We.get)(Q,["response","payload","data","ids"],null);if(fe&&Array.isArray(fe)){const Te=fe.join(`
`);q({type:"warning",message:Te})}else q({type:"warning",message:{id:"notification.error"}})}z()}),He=(0,e.useCallback)(Q=>{w(`/settings/roles/duplicate/${Q}`)},[w]),j=()=>w("/settings/roles/new"),me=(0,e.useCallback)(Q=>{ze({type:"SET_ROLE_TO_DELETE",id:Q}),z()},[]),z=()=>Y(Q=>!Q),H=(0,e.useCallback)(Q=>{w(`/settings/roles/${Q}`)},[w]),Se=(0,e.useCallback)((Q,fe)=>{Q.preventDefault(),Q.stopPropagation(),fe.usersCount?q({type:"info",message:{id:"Roles.ListPage.notification.delete-not-allowed"}}):me(fe.id)},[q,me]),Ie=(0,e.useCallback)((Q,fe)=>{Q.preventDefault(),Q.stopPropagation(),He(fe.id)},[He]),Ne=(0,e.useCallback)(Q=>[...ie?[{onClick:fe=>Ie(fe,Q),label:J({id:"app.utils.duplicate",defaultMessage:"Duplicate"}),icon:e.createElement(xe(),null)}]:[],...ae?[{onClick:()=>H(Q.id),label:J({id:"app.utils.edit",defaultMessage:"Edit"}),icon:e.createElement(I(),null)}]:[],...R?[{onClick:fe=>Se(fe,Q),label:J({id:"global.delete",defaultMessage:"Delete"}),icon:e.createElement(de(),null)}]:[]],[J,Se,Ie,H,ie,ae,R]);return{handleNewRoleClick:j,getIcons:Ne,selectedRoles:ve,isWarningDeleteAllOpened:_,showModalConfirmButtonLoading:Me,handleToggleModal:z,handleDeleteData:v}},we=()=>{const{formatMessage:G}=(0,Z.useIntl)(),{isLoadingForPermissions:ie,canCreate:R,canRead:ae,canDelete:J,canUpdate:q,isLoading:_,getData:Y,sortedRoles:w}=Ue(),{handleNewRoleClick:ve,getIcons:Me,isWarningDeleteAllOpened:Ye,showModalConfirmButtonLoading:ze,handleToggleModal:v,handleDeleteData:He}=Ze({getData:Y,canCreate:R,canDelete:J,canUpdate:q}),j=w.length+1,me=6;if(ie)return e.createElement(oe.Main,null,e.createElement(f.LoadingIndicatorPage,null));const z=G({id:"global.roles",defaultMessage:"roles"});return e.createElement(oe.Main,null,e.createElement(f.SettingsPageTitle,{name:"Roles"}),e.createElement(V.HeaderLayout,{primaryAction:R?e.createElement(T.Button,{onClick:ve,startIcon:e.createElement(B(),null),size:"L"},G({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})):null,title:z,subtitle:G({id:"Settings.roles.list.description",defaultMessage:"List of roles"}),as:"h2"}),ae&&e.createElement(V.ActionLayout,{startActions:e.createElement(f.SearchURLQuery,{label:G({id:"app.component.search.label",defaultMessage:"Search for {target}"},{target:z})})}),ae&&e.createElement(V.ContentLayout,null,e.createElement(ne.Table,{colCount:me,rowCount:j,footer:R?e.createElement(ne.TFooter,{onClick:ve,icon:e.createElement(B(),null)},G({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})):null},e.createElement(ne.Thead,null,e.createElement(ne.Tr,null,e.createElement(ne.Th,null,e.createElement(Ge.Typography,{variant:"sigma",textColor:"neutral600"},G({id:"global.name",defaultMessage:"Name"}))),e.createElement(ne.Th,null,e.createElement(Ge.Typography,{variant:"sigma",textColor:"neutral600"},G({id:"global.description",defaultMessage:"Description"}))),e.createElement(ne.Th,null,e.createElement(Ge.Typography,{variant:"sigma",textColor:"neutral600"},G({id:"global.users",defaultMessage:"Users"}))),e.createElement(ne.Th,null,e.createElement(pe.VisuallyHidden,null,G({id:"global.actions",defaultMessage:"Actions"}))))),e.createElement(ne.Tbody,null,w==null?void 0:w.map(H=>e.createElement(be.Z,{key:H.id,id:H.id,name:H.name,description:H.description,usersCount:H.usersCount,icons:Me(H)})))),!j&&!_&&e.createElement(je.Z,null)),e.createElement(f.ConfirmDialog,{isOpen:Ye,onConfirm:He,isConfirmButtonLoading:ze,onToggleDialog:v}))},W=()=>e.createElement(f.CheckPagePermissions,{permissions:r.Z.settings.roles.main},e.createElement(we,null))},49475:(k,C,n)=>{n.d(C,{Z:()=>U});var e=(B,le,de)=>new Promise((ue,xe)=>{var te=V=>{try{T(de.next(V))}catch(pe){xe(pe)}},I=V=>{try{T(de.throw(V))}catch(pe){xe(pe)}},T=V=>V.done?ue(V.value):Promise.resolve(V.value).then(te,I);T((de=de.apply(B,le)).next())});const U=[...strapi.features.isEnabled(strapi.features.SSO)?[{Component:()=>e(void 0,null,function*(){return yield n.e(302).then(n.bind(n,6688))}),to:"/settings/single-sign-on",exact:!0}]:[]]}}]);
