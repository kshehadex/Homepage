"use strict";var re=(z,u,e)=>new Promise((t,s)=>{var l=o=>{try{E(e.next(o))}catch(p){s(p)}},c=o=>{try{E(e.throw(o))}catch(p){s(p)}},E=o=>o.done?t(o.value):Promise.resolve(o.value).then(l,c);E((e=e.apply(z,u)).next())});(globalThis.webpackChunkwebsite_admin=globalThis.webpackChunkwebsite_admin||[]).push([[4263],{86294:(z,u,e)=>{e.r(u),e.d(u,{default:()=>ue});var t=e(53547),s=e(68547),l=e(49656),c=e(96486),E=e(92699),o=e(87462),p=e(97132),d=e(45697),O=e.n(d),g=e(78718),v=e.n(g),h=e(27361),H=e.n(h),j=e(57557),N=e.n(j),F=e(23724),$=e(80831),A=e(94117),T=e(64459),y=e(39272),f=e(35395),P=e(33483),M=e(80117),C=e(9524),Z=e(87760),b=e.n(Z),I=e(22754),r=e.n(I),a=e(58836),n=e(63955),J=(U,D,i)=>new Promise((B,R)=>{var Y=W=>{try{Q(i.next(W))}catch(w){R(w)}},X=W=>{try{Q(i.throw(W))}catch(w){R(w)}},Q=W=>W.done?B(W.value):Promise.resolve(W.value).then(Y,X);Q((i=i.apply(U,D)).next())});const ee=U=>J(void 0,null,function*(){const{data:D}=yield n.be.get(`/admin/users/${U}`);return D.data}),G=(U,D)=>J(void 0,null,function*(){const{data:i}=yield n.be.put(`/admin/users/${U}`,D);return i.data}),oe=[[{intlLabel:{id:"Auth.form.firstname.label",defaultMessage:"First name"},name:"firstname",placeholder:{id:"Auth.form.firstname.placeholder",defaultMessage:"e.g. Kai"},type:"text",size:{col:6,xs:12},required:!0},{intlLabel:{id:"Auth.form.lastname.label",defaultMessage:"Last name"},name:"lastname",placeholder:{id:"Auth.form.lastname.placeholder",defaultMessage:"e.g. Doe"},type:"text",size:{col:6,xs:12}}],[{intlLabel:{id:"Auth.form.email.label",defaultMessage:"Email"},name:"email",placeholder:{id:"Auth.form.email.placeholder",defaultMessage:"e.g. kai.doe@strapi.io"},type:"email",size:{col:6,xs:12},required:!0},{intlLabel:{id:"Auth.form.username.label",defaultMessage:"Username"},name:"username",placeholder:{id:"Auth.form.username.placeholder",defaultMessage:"e.g. Kai_Doe"},type:"email",size:{col:6,xs:12}}],[{intlLabel:{id:"global.password",defaultMessage:"Password"},name:"password",type:"password",size:{col:6,xs:12}},{intlLabel:{id:"Auth.form.confirmPassword.label",defaultMessage:"Password confirmation"},name:"confirmPassword",type:"password",size:{col:6,xs:12}}],[{intlLabel:{id:"Auth.form.active.label",defaultMessage:"Active"},name:"isActive",type:"bool",size:{col:6,xs:12}}]];var le=e(8278),ie=e(7676),de=e(25108);const ce=(()=>window&&window.strapi&&window.strapi.isEE?e(77791).Z:e(26010).Z)(),te=["email","firstname","lastname","username","isActive","roles"],ae=U=>{let{canUpdate:D}=U;const{formatMessage:i}=(0,p.useIntl)(),{params:{id:B}}=(0,l.useRouteMatch)("/settings/users/:id"),{push:R}=(0,l.useHistory)(),{setUserDisplayName:Y}=(0,s.useAppInfos)(),X=(0,s.useNotification)(),{lockApp:Q,unlockApp:W}=(0,s.useOverlayBlocker)();(0,s.useFocusWhenNavigate)();const{status:w,data:L}=(0,F.useQuery)(["user",B],()=>ee(B),{retry:!1,keepPreviousData:!1,staleTime:1e3*20,onError:m=>{m.response.status===403&&(X({type:"info",message:{id:"notification.permission.not-allowed-read",defaultMessage:"You are not allowed to see this document"}}),R("/")),de.log(m.response.status)}}),Ee=(m,_)=>re(this,null,function*(){Q();try{const K=yield G(B,N()(m,"confirmPassword"));X({type:"success",message:i({id:"notification.success.saved",defaultMessage:"Saved"})});const S=s.auth.getUserInfo();if(B.toString()===S.id.toString()){s.auth.setUserInfo(K);const V=H()(m,"username")||(0,a.Pp)(m.firstname,m.lastname);Y(V)}_.setValues(v()(m,te))}catch(K){const S=(0,a.Iz)(K.response.data),V=Object.keys(S).reduce((q,x)=>(q[x]=S[x].id,q),{});_.setErrors(V),X({type:"warning",message:H()(K,"response.data.message","notification.error")})}W()}),se=w!=="success",pe=se?{id:"app.containers.Users.EditPage.header.label-loading",defaultMessage:"Edit user"}:{id:"app.containers.Users.EditPage.header.label",defaultMessage:"Edit {name}"},k=Object.keys(v()(L,te)).reduce((m,_)=>_==="roles"?(m[_]=((L==null?void 0:L.roles)||[]).map(K=>{let{id:S}=K;return S}),m):(m[_]=L==null?void 0:L[_],m),{}),ge=k.username||(0,a.Pp)(k.firstname,k.lastname),ne=i(pe,{name:ge});return se?t.createElement(M.Main,{"aria-busy":"true"},t.createElement(s.SettingsPageTitle,{name:"Users"}),t.createElement(f.HeaderLayout,{primaryAction:t.createElement(T.Button,{disabled:!0,startIcon:t.createElement(r(),null),type:"button",size:"L"},i({id:"global.save",defaultMessage:"Save"})),title:ne,navigationAction:t.createElement(s.Link,{startIcon:t.createElement(b(),null),to:"/settings/users?pageSize=10&page=1&sort=firstname"},i({id:"global.back",defaultMessage:"Back"}))}),t.createElement(f.ContentLayout,null,t.createElement(s.LoadingIndicatorPage,null))):t.createElement(M.Main,null,t.createElement(s.SettingsPageTitle,{name:"Users"}),t.createElement($.Formik,{onSubmit:Ee,initialValues:k,validateOnChange:!1,validationSchema:le.YM},m=>{let{errors:_,values:K,handleChange:S,isSubmitting:V}=m;return t.createElement(s.Form,null,t.createElement(f.HeaderLayout,{primaryAction:t.createElement(T.Button,{disabled:V||!D,startIcon:t.createElement(r(),null),loading:V,type:"submit",size:"L"},i({id:"global.save",defaultMessage:"Save"})),title:ne,navigationAction:t.createElement(s.Link,{startIcon:t.createElement(b(),null),to:"/settings/users?pageSize=10&page=1&sort=firstname"},i({id:"global.back",defaultMessage:"Back"}))}),t.createElement(f.ContentLayout,null,(L==null?void 0:L.registrationToken)&&t.createElement(A.Box,{paddingBottom:6},t.createElement(ce,{registrationToken:L.registrationToken})),t.createElement(C.Stack,{spacing:7},t.createElement(A.Box,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7},t.createElement(C.Stack,{spacing:4},t.createElement(P.Typography,{variant:"delta",as:"h2"},i({id:"app.components.Users.ModalCreateBody.block-title.details",defaultMessage:"Details"})),t.createElement(y.Grid,{gap:5},oe.map(q=>q.map(x=>t.createElement(y.GridItem,(0,o.Z)({key:x.name},x.size),t.createElement(s.GenericInput,(0,o.Z)({},x,{disabled:!D,error:_[x.name],onChange:S,value:K[x.name]||""})))))))),t.createElement(A.Box,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7},t.createElement(C.Stack,{spacing:4},t.createElement(P.Typography,{variant:"delta",as:"h2"},i({id:"global.roles",defaultMessage:"User's role"})),t.createElement(y.Grid,{gap:5},t.createElement(y.GridItem,{col:6,xs:12},t.createElement(ie.Z,{disabled:!D,error:_.roles,onChange:S,value:K.roles}))))))))}))};ae.propTypes={canUpdate:O().bool.isRequired};const me=ae,ue=()=>{const U=(0,s.useNotification)(),D=(0,t.useMemo)(()=>({read:E.Z.settings.users.read,update:E.Z.settings.users.update}),[]),{isLoading:i,allowedActions:{canRead:B,canUpdate:R}}=(0,s.useRBAC)(D),{state:Y}=(0,l.useLocation)(),X=(0,c.get)(Y,"from","/");return(0,t.useEffect)(()=>{i||!B&&!R&&U({type:"info",message:{id:"notification.permission.not-allowed-read",defaultMessage:"You are not allowed to see this document"}})},[i,B,R,U]),i?t.createElement(s.LoadingIndicatorPage,null):!B&&!R?t.createElement(l.Redirect,{to:X}):t.createElement(me,{canUpdate:R})}},53073:(z,u,e)=>{e.d(u,{Z:()=>F});var t=e(53547),s=e(45697),l=e.n(s),c=e(49549),E=e.n(c),o=e(68547),p=e.n(o),d=e(54279),O=e.n(d),g=e(74855),v=e.n(g),h=e(97132),H=e.n(h);const j=()=>t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg"},t.createElement("text",{transform:"translate(-23 -9)",fill:"#4B515A",fillRule:"evenodd",fontSize:"32",fontFamily:"AppleColorEmoji, Apple Color Emoji"},t.createElement("tspan",{x:"23",y:"36"},"\u2709\uFE0F"))),N=({children:$,target:A})=>{const T=(0,o.useNotification)(),{formatMessage:y}=(0,h.useIntl)(),f=()=>{T({type:"info",message:{id:"notification.link-copied"}})},P=y({id:"app.component.CopyToClipboard.label",defaultMessage:"Copy to clipboard"});return t.createElement(o.ContentBox,{endAction:t.createElement(g.CopyToClipboard,{onCopy:f,text:A},t.createElement(c.IconButton,{label:P,noBorder:!0,icon:t.createElement(O(),null)})),title:A,titleEllipsis:!0,subtitle:$,icon:t.createElement(j,null),iconBackground:"neutral100"})};N.propTypes={children:l().oneOfType([l().element,l().string]).isRequired,target:l().string.isRequired};const F=N},26010:(z,u,e)=>{e.d(u,{Z:()=>O});var t=e(53547),s=e(97132),l=e.n(s),c=e(45697),E=e.n(c),o=e(71242),p=e(53073);const d=({registrationToken:g})=>{const{formatMessage:v}=(0,s.useIntl)(),h=`${window.location.origin}${o.Z}auth/register?registrationToken=${g}`;return t.createElement(p.Z,{target:h},v({id:"app.components.Users.MagicLink.connect",defaultMessage:"Copy and share this link to give access to this user"}))};d.defaultProps={registrationToken:""},d.propTypes={registrationToken:E().string};const O=d},7676:(z,u,e)=>{e.d(u,{Z:()=>y});var t=e(53547),s=e(45697),l=e.n(s),c=e(97132),E=e.n(c),o=e(2632),p=e.n(o),d=e(23724),O=e.n(d),g=e(78384),v=e(79386),h=e.n(v),H=e(63955),j=(f,P,M)=>new Promise((C,Z)=>{var b=a=>{try{r(M.next(a))}catch(n){Z(n)}},I=a=>{try{r(M.throw(a))}catch(n){Z(n)}},r=a=>a.done?C(a.value):Promise.resolve(a.value).then(b,I);r((M=M.apply(f,P)).next())});const N=g.keyframes`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(359deg);
  }
`,F=g.default.div`
  animation: ${N} 2s infinite linear;
`,$=()=>t.createElement(F,null,t.createElement(h(),null)),A=()=>j(void 0,null,function*(){const{data:f}=yield H.be.get("/admin/roles");return f.data}),T=({disabled:f,error:P,onChange:M,value:C})=>{const{status:Z,data:b}=(0,d.useQuery)(["roles"],A,{staleTime:5e4}),{formatMessage:I}=(0,c.useIntl)(),r=P?I({id:P,defaultMessage:P}):"",a=I({id:"app.components.Users.ModalCreateBody.block-title.roles",defaultMessage:"User's roles"}),n=I({id:"app.components.Users.ModalCreateBody.block-title.roles.description",defaultMessage:"A user can have one or several roles"}),J=I({id:"app.components.Select.placeholder",defaultMessage:"Select"}),ee=Z==="loading"?t.createElement($,null):void 0;return t.createElement(o.Select,{id:"roles",disabled:f,error:r,hint:n,label:a,name:"roles",onChange:G=>{M({target:{name:"roles",value:G}})},placeholder:J,multi:!0,startIcon:ee,value:C,withTags:!0,required:!0},(b||[]).map(G=>t.createElement(o.Option,{key:G.id,value:G.id},G.name)))};T.defaultProps={disabled:!1,error:void 0},T.propTypes={disabled:l().bool,error:l().string,onChange:l().func.isRequired,value:l().array.isRequired};const y=T},8278:(z,u,e)=>{e.d(u,{YM:()=>I,Rw:()=>j});var t=e(53209),s=e(68547),l=Object.defineProperty,c=Object.defineProperties,E=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,p=Object.prototype.hasOwnProperty,d=Object.prototype.propertyIsEnumerable,O=(r,a,n)=>a in r?l(r,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):r[a]=n,g=(r,a)=>{for(var n in a||(a={}))p.call(a,n)&&O(r,n,a[n]);if(o)for(var n of o(a))d.call(a,n)&&O(r,n,a[n]);return r},v=(r,a)=>c(r,E(a));const h={firstname:t.nK().required(s.translatedErrors.required),lastname:t.nK(),email:t.Z_().email(s.translatedErrors.email).lowercase().required(s.translatedErrors.required),username:t.Z_().nullable(),password:t.Z_().min(8,s.translatedErrors.minLength).matches(/[a-z]/,"components.Input.error.contain.lowercase").matches(/[A-Z]/,"components.Input.error.contain.uppercase").matches(/\d/,"components.Input.error.contain.number"),confirmPassword:t.Z_().min(8,s.translatedErrors.minLength).oneOf([t.iH("password"),null],"components.Input.error.password.noMatch").when("password",(r,a)=>r?a.required(s.translatedErrors.required):a)},j=v(g({},h),{currentPassword:t.Z_().when(["password","confirmPassword"],(r,a,n)=>r||a?n.required(s.translatedErrors.required):n),preferedLanguage:t.Z_().nullable()}),F={roles:t.IX().min(1,s.translatedErrors.required).required(s.translatedErrors.required)};var $=Object.defineProperty,A=Object.defineProperties,T=Object.getOwnPropertyDescriptors,y=Object.getOwnPropertySymbols,f=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable,M=(r,a,n)=>a in r?$(r,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):r[a]=n,C=(r,a)=>{for(var n in a||(a={}))f.call(a,n)&&M(r,n,a[n]);if(y)for(var n of y(a))P.call(a,n)&&M(r,n,a[n]);return r},Z=(r,a)=>A(r,T(a));const I=t.Ry().shape(C(Z(C({},h),{isActive:t.Xg()}),F))},77791:(z,u,e)=>{e.d(u,{Z:()=>O});var t=e(53547),s=e(97132),l=e.n(s),c=e(45697),E=e.n(c),o=e(71242),p=e(53073);const d=({registrationToken:g})=>{const{formatMessage:v}=(0,s.useIntl)();return g?t.createElement(p.Z,{target:`${window.location.origin}${o.Z}auth/register?registrationToken=${g}`},v({id:"app.components.Users.MagicLink.connect",defaultMessage:"Copy and share this link to give access to this user"})):t.createElement(p.Z,{target:`${window.location.origin}${o.Z}auth/login`},v({id:"app.components.Users.MagicLink.connect.sso",defaultMessage:"Send this link to the user, the first login can be made via a SSO provider."}))};d.defaultProps={registrationToken:""},d.propTypes={registrationToken:E().string};const O=d}}]);
